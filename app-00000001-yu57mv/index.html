<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çµŒæ¸ˆæŒ‡æ¨™ãƒ»å¸‚å ´åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .main-content {
            background: white;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
            overflow-x: auto;
        }

        .tab {
            flex: 1;
            min-width: 140px;
            padding: 15px 10px;
            text-align: center;
            cursor: pointer;
            background: #f8f9fa;
            border: none;
            font-size: 13px;
            font-weight: 600;
            color: #6c757d;
            transition: all 0.3s;
        }

        .tab.active {
            background: white;
            color: #495057;
            border-bottom: 3px solid #007bff;
        }

        .tab:hover {
            background: #e9ecef;
        }

        .tab-content {
            display: none;
            padding: 25px;
            min-height: 700px;
        }

        .tab-content.active {
            display: block;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .widget {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: relative;
        }

        .widget h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .widget-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: white;
        }

        .indicator-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #007bff;
        }

        .indicator-value {
            font-size: 24px;
            font-weight: 700;
            color: #007bff;
            margin-bottom: 5px;
        }

        .indicator-change {
            font-size: 14px;
            font-weight: 600;
        }

        .indicator-change.positive {
            color: #28a745;
        }

        .indicator-change.negative {
            color: #dc3545;
        }

        .indicator-change.neutral {
            color: #6c757d;
        }

        .chart-container {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
            border: 1px solid #e9ecef;
        }

        .chart-container canvas {
            max-width: 100%;
            height: auto;
        }

        .control-panel {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .control-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .control-group label {
            font-weight: 600;
            color: #495057;
            font-size: 12px;
        }

        .control-group input, .control-group select {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .control-group input:focus, .control-group select:focus {
            outline: none;
            border-color: #007bff;
        }

        .btn {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
            font-size: 14px;
        }

        .btn:hover {
            background: #0056b3;
        }

        .btn.secondary {
            background: #6c757d;
        }

        .btn.secondary:hover {
            background: #5a6268;
        }

        .btn.success {
            background: #28a745;
        }

        .btn.success:hover {
            background: #218838;
        }

        .btn.danger {
            background: #dc3545;
        }

        .btn.danger:hover {
            background: #c82333;
        }

        .market-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .market-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .market-card h4 {
            color: #495057;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .market-price {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .market-change {
            font-size: 12px;
            font-weight: 600;
        }

        .simulation-panel {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .simulation-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .slider-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .slider-group input[type="range"] {
            width: 100%;
        }

        .slider-value {
            font-weight: 600;
            color: #007bff;
            text-align: center;
        }

        .portfolio-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .asset-list {
            background: white;
            border-radius: 8px;
            padding: 15px;
            max-height: 400px;
            overflow-y: auto;
        }

        .asset-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #e9ecef;
            cursor: pointer;
            transition: background 0.3s;
        }

        .asset-item:hover {
            background: #f8f9fa;
        }

        .asset-item.selected {
            background: #e3f2fd;
            border-left: 4px solid #007bff;
        }

        .risk-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .risk-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e9ecef;
        }

        .risk-value {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .risk-label {
            font-size: 12px;
            color: #6c757d;
        }

        .news-feed {
            background: white;
            border-radius: 8px;
            padding: 15px;
            max-height: 500px;
            overflow-y: auto;
        }

        .news-item {
            padding: 10px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .news-item:last-child {
            border-bottom: none;
        }

        .news-title {
            font-weight: 600;
            color: #495057;
            margin-bottom: 5px;
        }

        .news-meta {
            font-size: 12px;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .news-summary {
            font-size: 14px;
            color: #666;
            line-height: 1.4;
        }

        .learning-content {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .learning-content h4 {
            color: #856404;
            margin-bottom: 15px;
        }

        .learning-content p {
            color: #856404;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .formula {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin: 10px 0;
            border-left: 4px solid #007bff;
        }

        .interactive-chart {
            position: relative;
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .chart-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .data-table th, .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .data-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        .alert-panel {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .alert-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #c3e6cb;
        }

        .alert-item:last-child {
            border-bottom: none;
        }

        .alert-message {
            font-weight: 600;
            color: #155724;
        }

        .alert-time {
            font-size: 12px;
            color: #155724;
            opacity: 0.8;
        }

        .tutorial {
            background: #e3f2fd;
            border: 1px solid #bbdefb;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .tutorial h4 {
            color: #1565c0;
            margin-bottom: 10px;
        }

        .tutorial p {
            color: #1565c0;
            font-size: 14px;
            line-height: 1.5;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .tabs {
                flex-direction: column;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .portfolio-grid {
                grid-template-columns: 1fr;
            }

            .control-row {
                flex-direction: column;
                align-items: stretch;
            }

            .market-summary {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }

        .status-online {
            background: #28a745;
            animation: pulse 2s infinite;
        }

        .status-offline {
            background: #dc3545;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .correlation-matrix {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 2px;
            margin: 15px 0;
        }

        .correlation-cell {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            color: white;
            border-radius: 4px;
        }

        .heatmap-legend {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            font-size: 12px;
        }

        .legend-bar {
            width: 100px;
            height: 15px;
            background: linear-gradient(to right, #dc3545, #ffc107, #28a745);
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š çµŒæ¸ˆæŒ‡æ¨™ãƒ»å¸‚å ´åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
            <p>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çµŒæ¸ˆãƒ‡ãƒ¼ã‚¿ã¨é‡‘èå¸‚å ´ã®åŒ…æ‹¬çš„åˆ†æãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </p>
        </div>

        <div class="main-content">
            <div class="tabs">
                <button class="tab active" data-tab="dashboard">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</button>
                <button class="tab" data-tab="economic">çµŒæ¸ˆæŒ‡æ¨™</button>
                <button class="tab" data-tab="markets">é‡‘èå¸‚å ´</button>
                <button class="tab" data-tab="simulation">çµŒæ¸ˆç†è«–</button>
                <button class="tab" data-tab="portfolio">ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª</button>
                <button class="tab" data-tab="learning">å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰</button>
                <button class="tab" data-tab="alerts">ã‚¢ãƒ©ãƒ¼ãƒˆ</button>
            </div>

            <!-- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¿ãƒ– -->
            <div class="tab-content active" id="dashboard">
                <div class="tutorial">
                    <h4>ğŸ“š çµŒæ¸ˆæŒ‡æ¨™ãƒ»å¸‚å ´åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h4>
                    <p>ä¸»è¦ãªçµŒæ¸ˆæŒ‡æ¨™ã¨é‡‘èå¸‚å ´ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç›£è¦–ã§ãã¾ã™ã€‚å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è©³ç´°ãªåˆ†æã‚’è¡¨ç¤ºã§ãã¾ã™ã€‚</p>
                </div>

                <div class="control-panel">
                    <div class="control-row">
                        <div class="control-group">
                            <label>ãƒ‡ãƒ¼ã‚¿æ›´æ–°é–“éš”</label>
                            <select id="updateInterval">
                                <option value="1">1ç§’</option>
                                <option value="5" selected>5ç§’</option>
                                <option value="30">30ç§’</option>
                                <option value="60">1åˆ†</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>è¡¨ç¤ºæœŸé–“</label>
                            <select id="timeRange">
                                <option value="1D">1æ—¥</option>
                                <option value="1W" selected>1é€±é–“</option>
                                <option value="1M">1ãƒ¶æœˆ</option>
                                <option value="1Y">1å¹´</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>ãƒ‡ãƒ¼ã‚¿æ¥ç¶šçŠ¶æ³</label>
                            <div>
                                <span class="status-indicator status-online"></span>
                                <span>ã‚ªãƒ³ãƒ©ã‚¤ãƒ³</span>
                            </div>
                        </div>
                        <button class="btn" onclick="refreshAllData()">å…¨ãƒ‡ãƒ¼ã‚¿æ›´æ–°</button>
                        <button class="btn secondary" onclick="exportData()">ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
                    </div>
                </div>

                <div class="market-summary">
                    <div class="market-card">
                        <h4>æ—¥çµŒå¹³å‡</h4>
                        <div class="market-price" style="color: #28a745;">39,580.50</div>
                        <div class="market-change positive">+245.30 (+0.62%)</div>
                    </div>
                    <div class="market-card">
                        <h4>TOPIX</h4>
                        <div class="market-price" style="color: #28a745;">2,785.20</div>
                        <div class="market-change positive">+15.80 (+0.57%)</div>
                    </div>
                    <div class="market-card">
                        <h4>USD/JPY</h4>
                        <div class="market-price" style="color: #dc3545;">154.25</div>
                        <div class="market-change negative">-0.45 (-0.29%)</div>
                    </div>
                    <div class="market-card">
                        <h4>10å¹´å‚µåˆ©å›ã‚Š</h4>
                        <div class="market-price" style="color: #28a745;">0.825%</div>
                        <div class="market-change positive">+0.015%</div>
                    </div>
                    <div class="market-card">
                        <h4>åŸæ²¹(WTI)</h4>
                        <div class="market-price" style="color: #dc3545;">$72.45</div>
                        <div class="market-change negative">-$1.25 (-1.70%)</div>
                    </div>
                    <div class="market-card">
                        <h4>é‡‘(NY)</h4>
                        <div class="market-price" style="color: #28a745;">$2,415.30</div>
                        <div class="market-change positive">+$8.50 (+0.35%)</div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="widget">
                        <h3>
                            <div class="widget-icon" style="background: #007bff;">ğŸ“ˆ</div>
                            ä¸»è¦çµŒæ¸ˆæŒ‡æ¨™
                        </h3>
                        <div class="indicator-card">
                            <div class="indicator-value">2.1%</div>
                            <div>GDPæˆé•·ç‡ï¼ˆå¹´ç‡ï¼‰</div>
                            <div class="indicator-change positive">+0.3% å‰æœŸæ¯”</div>
                        </div>
                        <div class="indicator-card">
                            <div class="indicator-value">2.8%</div>
                            <div>æ¶ˆè²»è€…ç‰©ä¾¡æŒ‡æ•°ï¼ˆCPIï¼‰</div>
                            <div class="indicator-change neutral">Â±0.0% å‰æœˆæ¯”</div>
                        </div>
                        <div class="indicator-card">
                            <div class="indicator-value">2.4%</div>
                            <div>å®Œå…¨å¤±æ¥­ç‡</div>
                            <div class="indicator-change negative">+0.1% å‰æœˆæ¯”</div>
                        </div>
                    </div>

                    <div class="widget">
                        <h3>
                            <div class="widget-icon" style="background: #28a745;">ğŸ“Š</div>
                            å¸‚å ´å‹•å‘
                        </h3>
                        <div class="chart-container">
                            <canvas id="marketTrendChart" width="300" height="200"></canvas>
                        </div>
                    </div>

                    <div class="widget">
                        <h3>
                            <div class="widget-icon" style="background: #dc3545;">ğŸŒ</div>
                            å›½éš›æ¯”è¼ƒ
                        </h3>
                        <div class="chart-container">
                            <canvas id="internationalChart" width="300" height="200"></canvas>
                        </div>
                    </div>

                    <div class="widget news-feed">
                        <h3>
                            <div class="widget-icon" style="background: #ffc107;">ğŸ“°</div>
                            çµŒæ¸ˆãƒ‹ãƒ¥ãƒ¼ã‚¹
                        </h3>
                        <div class="news-item">
                            <div class="news-title">æ—¥éŠ€ã€æ”¿ç­–é‡‘åˆ©ã‚’0.25%ã«å¼•ãä¸Šã’</div>
                            <div class="news-meta">2025-07-28 15:30 | æ—¥æœ¬çµŒæ¸ˆæ–°è</div>
                            <div class="news-summary">æ—¥æœ¬éŠ€è¡Œã¯é‡‘èæ”¿ç­–æ±ºå®šä¼šåˆã§ã€æ”¿ç­–é‡‘åˆ©ã‚’0.25%ã«å¼•ãä¸Šã’ã‚‹ã“ã¨ã‚’æ±ºå®šã—ãŸã€‚ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ã®ä¸Šæ˜‡ã‚’å—ã‘ãŸæªç½®ã€‚</div>
                        </div>
                        <div class="news-item">
                            <div class="news-title">ç±³é›‡ç”¨çµ±è¨ˆã€äºˆæƒ³ã‚’ä¸Šå›ã‚‹</div>
                            <div class="news-meta">2025-07-28 14:45 | Reuters</div>
                            <div class="news-summary">6æœˆã®ç±³é›‡ç”¨çµ±è¨ˆã§éè¾²æ¥­éƒ¨é–€é›‡ç”¨è€…æ•°ãŒäºˆæƒ³ã‚’ä¸Šå›ã‚‹25ä¸‡äººå¢—ã¨ãªã‚Šã€åŠ´åƒå¸‚å ´ã®å …èª¿ã•ã‚’ç¤ºã—ãŸã€‚</div>
                        </div>
                        <div class="news-item">
                            <div class="news-title">ä¸­å›½GDPã€ç¬¬2å››åŠæœŸ5.2%æˆé•·</div>
                            <div class="news-meta">2025-07-28 13:20 | Bloomberg</div>
                            <div class="news-summary">ä¸­å›½ã®ç¬¬2å››åŠæœŸGDPæˆé•·ç‡ã¯å‰å¹´åŒæœŸæ¯”5.2%ã¨ãªã‚Šã€æ”¿åºœç›®æ¨™ã®5%ã‚’ä¸Šå›ã£ãŸã€‚</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- çµŒæ¸ˆæŒ‡æ¨™ã‚¿ãƒ– -->
            <div class="tab-content" id="economic">
                <div class="tutorial">
                    <h4>ğŸ“š çµŒæ¸ˆæŒ‡æ¨™åˆ†æ</h4>
                    <p>ä¸»è¦ãªçµŒæ¸ˆæŒ‡æ¨™ã®æ¨ç§»ã‚’æ™‚ç³»åˆ—ã§åˆ†æã—ã€çµŒæ¸ˆã‚µã‚¤ã‚¯ãƒ«ã®ç†è§£ã‚’æ·±ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
                </div>

                <div class="control-panel">
                    <div class="control-row">
                        <div class="control-group">
                            <label>å›½ãƒ»åœ°åŸŸ</label>
                            <select id="economicRegion">
                                <option value="japan" selected>æ—¥æœ¬</option>
                                <option value="usa">ã‚¢ãƒ¡ãƒªã‚«</option>
                                <option value="eurozone">ãƒ¦ãƒ¼ãƒ­åœ</option>
                                <option value="china">ä¸­å›½</option>
                                <option value="global">ã‚°ãƒ­ãƒ¼ãƒãƒ«</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>æŒ‡æ¨™ã‚«ãƒ†ã‚´ãƒª</label>
                            <select id="indicatorCategory">
                                <option value="growth">æˆé•·æŒ‡æ¨™</option>
                                <option value="inflation">ç‰©ä¾¡æŒ‡æ¨™</option>
                                <option value="employment">é›‡ç”¨æŒ‡æ¨™</option>
                                <option value="monetary">é‡‘èæŒ‡æ¨™</option>
                                <option value="trade">è²¿æ˜“æŒ‡æ¨™</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>è¡¨ç¤ºå½¢å¼</label>
                            <select id="displayFormat">
                                <option value="level">æ°´æº–å€¤</option>
                                <option value="yoy">å‰å¹´åŒæœˆæ¯”</option>
                                <option value="mom">å‰æœˆæ¯”</option>
                                <option value="qoq">å‰æœŸæ¯”</option>
                            </select>
                        </div>
                        <button class="btn" onclick="updateEconomicChart()">ãƒãƒ£ãƒ¼ãƒˆæ›´æ–°</button>
                        <button class="btn secondary" onclick="compareCountries()">å›½éš›æ¯”è¼ƒ</button>
                    </div>
                </div>

                <div class="interactive-chart">
                    <div class="chart-controls">
                        <button class="btn" onclick="addTrendline()">ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³</button>
                        <button class="btn" onclick="addMovingAverage()">ç§»å‹•å¹³å‡</button>
                        <button class="btn" onclick="detectCycles()">ã‚µã‚¤ã‚¯ãƒ«æ¤œå‡º</button>
                        <button class="btn secondary" onclick="exportChart()">ãƒãƒ£ãƒ¼ãƒˆä¿å­˜</button>
                    </div>
                    <canvas id="economicIndicatorChart" width="800" height="400"></canvas>
                </div>

                <div class="dashboard-grid">
                    <div class="widget">
                        <h3>ğŸ“Š æŒ‡æ¨™è©³ç´°</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>æŒ‡æ¨™å</th>
                                    <th>æœ€æ–°å€¤</th>
                                    <th>å‰æœŸæ¯”</th>
                                    <th>å‰å¹´æ¯”</th>
                                    <th>æ›´æ–°æ—¥</th>
                                </tr>
                            </thead>
                            <tbody id="indicatorTableBody">
                                <tr>
                                    <td>å®Ÿè³ªGDP</td>
                                    <td>543.2å…†å††</td>
                                    <td class="positive">+0.5%</td>
                                    <td class="positive">+2.1%</td>
                                    <td>2025-07-15</td>
                                </tr>
                                <tr>
                                    <td>æ¶ˆè²»è€…ç‰©ä¾¡æŒ‡æ•°</td>
                                    <td>106.8</td>
                                    <td class="neutral">+0.0%</td>
                                    <td class="positive">+2.8%</td>
                                    <td>2025-07-26</td>
                                </tr>
                                <tr>
                                    <td>å®Œå…¨å¤±æ¥­ç‡</td>
                                    <td>2.4%</td>
                                    <td class="negative">+0.1pt</td>
                                    <td class="negative">+0.2pt</td>
                                    <td>2025-07-30</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="widget">
                        <h3>ğŸ” ç›¸é–¢åˆ†æ</h3>
                        <div class="correlation-matrix" id="correlationMatrix"></div>
                        <div class="heatmap-legend">
                            <span>-1.0</span>
                            <div class="legend-bar"></div>
                            <span>+1.0</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- é‡‘èå¸‚å ´ã‚¿ãƒ– -->
            <div class="tab-content" id="markets">
                <div class="tutorial">
                    <h4>ğŸ“š é‡‘èå¸‚å ´åˆ†æ</h4>
                    <p>æ ªå¼ã€å‚µåˆ¸ã€ç‚ºæ›¿ã€å•†å“å¸‚å ´ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ†æã¨ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™ã‚’æä¾›ã—ã¾ã™ã€‚</p>
                </div>

                <div class="control-panel">
                    <div class="control-row">
                        <div class="control-group">
                            <label>å¸‚å ´</label>
                            <select id="marketType">
                                <option value="stocks" selected>æ ªå¼</option>
                                <option value="bonds">å‚µåˆ¸</option>
                                <option value="forex">ç‚ºæ›¿</option>
                                <option value="commodities">å•†å“</option>
                                <option value="crypto">æš—å·è³‡ç”£</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>éŠ˜æŸ„ãƒ»æŒ‡æ•°</label>
                            <select id="securitySelect">
                                <option value="nikkei">æ—¥çµŒå¹³å‡</option>
                                <option value="topix">TOPIX</option>
                                <option value="sp500">S&P500</option>
                                <option value="nasdaq">NASDAQ</option>
                                <option value="dji">ãƒ€ã‚¦å¹³å‡</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>ãƒãƒ£ãƒ¼ãƒˆç¨®é¡</label>
                            <select id="chartType">
                                <option value="candlestick">ãƒ­ãƒ¼ã‚½ã‚¯è¶³</option>
                                <option value="line">ç·šã‚°ãƒ©ãƒ•</option>
                                <option value="area">é¢ã‚°ãƒ©ãƒ•</option>
                                <option value="volume">å‡ºæ¥é«˜</option>
                            </select>
                        </div>
                        <button class="btn" onclick="updateMarketChart()">æ›´æ–°</button>
                        <button class="btn secondary" onclick="addTechnicalIndicator()">ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«è¿½åŠ </button>
                    </div>
                </div>

                <div class="interactive-chart">
                    <canvas id="marketChart" width="800" height="500"></canvas>
                    <div class="chart-controls">
                        <button class="btn" onclick="addMA(25)">MA25</button>
                        <button class="btn" onclick="addMA(75)">MA75</button>
                        <button class="btn" onclick="addBollinger()">ãƒœãƒªãƒ³ã‚¸ãƒ£ãƒ¼</button>
                        <button class="btn" onclick="addRSI()">RSI</button>
                        <button class="btn" onclick="addMACD()">MACD</button>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="widget">
                        <h3>ğŸ“ˆ ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™</h3>
                        <div class="risk-metrics">
                            <div class="risk-card">
                                <div class="risk-value">67.5</div>
                                <div class="risk-label">RSI (14)</div>
                            </div>
                            <div class="risk-card">
                                <div class="risk-value">+125</div>
                                <div class="risk-label">MACD</div>
                            </div>
                            <div class="risk-card">
                                <div class="risk-value">18.5%</div>
                                <div class="risk-label">ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£</div>
                            </div>
                            <div class="risk-card">
                                <div class="risk-value">0.85</div>
                                <div class="risk-label">ãƒ™ãƒ¼ã‚¿å€¤</div>
                            </div>
                        </div>
                    </div>

                    <div class="widget">
                        <h3>ğŸ’¹ å¸‚å ´çµ±è¨ˆ</h3>
                        <div class="chart-container">
                            <canvas id="marketStatsChart" width="300" height="200"></canvas>
                        </div>
                    </div>

                    <div class="widget">
                        <h3>ğŸŒ ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆ</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>é€šè²¨ãƒšã‚¢</th>
                                    <th>ç¾åœ¨å€¤</th>
                                    <th>å¤‰åŒ–é¡</th>
                                    <th>å¤‰åŒ–ç‡</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>USD/JPY</td>
                                    <td>154.25</td>
                                    <td class="negative">-0.45</td>
                                    <td class="negative">-0.29%</td>
                                </tr>
                                <tr>
                                    <td>EUR/JPY</td>
                                    <td>167.80</td>
                                    <td class="positive">+0.25</td>
                                    <td class="positive">+0.15%</td>
                                </tr>
                                <tr>
                                    <td>GBP/JPY</td>
                                    <td>195.45</td>
                                    <td class="positive">+0.85</td>
                                    <td class="positive">+0.44%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="widget">
                        <h3>ğŸ“Š ã‚»ã‚¯ã‚¿ãƒ¼åˆ†æ</h3>
                        <div class="chart-container">
                            <canvas id="sectorChart" width="300" height="200"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- çµŒæ¸ˆç†è«–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ãƒ– -->
            <div class="tab-content" id="simulation">
                <div class="tutorial">
                    <h4>ğŸ“š çµŒæ¸ˆç†è«–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
                    <p>IS-LMåˆ†æã€AD-ASåˆ†æã€æˆé•·ç†è«–ãªã©ã®çµŒæ¸ˆãƒ¢ãƒ‡ãƒ«ã‚’ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«å­¦ç¿’ã§ãã¾ã™ã€‚</p>
                </div>

                <div class="simulation-panel">
                    <h3>IS-LMåˆ†æã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h3>
                    <div class="simulation-controls">
                        <div class="slider-group">
                            <label>æ”¿åºœæ”¯å‡º (G)</label>
                            <input type="range" id="govSpending" min="50" max="150" value="100" oninput="updateISLM()">
                            <div class="slider-value" id="govSpendingValue">100</div>
                        </div>
                        <div class="slider-group">
                            <label>ç¨ç‡ (t)</label>
                            <input type="range" id="taxRate" min="10" max="40" value="25" oninput="updateISLM()">
                            <div class="slider-value" id="taxRateValue">25%</div>
                        </div>
                        <div class="slider-group">
                            <label>ãƒãƒãƒ¼ã‚µãƒ—ãƒ©ã‚¤ (M)</label>
                            <input type="range" id="moneySupply" min="80" max="120" value="100" oninput="updateISLM()">
                            <div class="slider-value" id="moneySupplyValue">100</div>
                        </div>
                        <div class="slider-group">
                            <label>æŠ•è³‡æ„Ÿå¿œåº¦</label>
                            <input type="range" id="investSensitivity" min="50" max="150" value="100" oninput="updateISLM()">
                            <div class="slider-value" id="investSensitivityValue">100</div>
                        </div>
                    </div>
                    
                    <div class="interactive-chart">
                        <canvas id="islmChart" width="600" height="400"></canvas>
                    </div>

                    <div class="learning-content">
                        <h4>IS-LMãƒ¢ãƒ‡ãƒ«ã®åŸºæœ¬æ¦‚å¿µ</h4>
                        <p><strong>ISæ›²ç·š</strong>: æ¶ˆè²»å¸‚å ´ï¼ˆæŠ•è³‡=è²¯è“„ï¼‰ã®å‡è¡¡ã‚’è¡¨ã™</p>
                        <p><strong>LMæ›²ç·š</strong>: è²¨å¹£å¸‚å ´ï¼ˆæµå‹•æ€§=ãƒãƒãƒ¼ã‚µãƒ—ãƒ©ã‚¤ï¼‰ã®å‡è¡¡ã‚’è¡¨ã™</p>
                        <div class="formula">
                            IS: Y = C(Y-T) + I(r) + G + NX<br>
                            LM: M/P = L(Y, r)
                        </div>
                        <p>ä¸¡æ›²ç·šã®äº¤ç‚¹ã§è²¡å¸‚å ´ã¨è²¨å¹£å¸‚å ´ãŒåŒæ™‚å‡è¡¡ã—ã€å‡è¡¡GDP(Y)ã¨å‡è¡¡åˆ©å­ç‡(r)ãŒæ±ºå®šã•ã‚Œã¾ã™ã€‚</p>
                    </div>
                </div>

                <div class="simulation-panel">
                    <h3>AD-ASåˆ†æã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h3>
                    <div class="simulation-controls">
                        <div class="slider-group">
                            <label>ç·éœ€è¦ã‚·ãƒ§ãƒƒã‚¯</label>
                            <input type="range" id="demandShock" min="-20" max="20" value="0" oninput="updateADAS()">
                            <div class="slider-value" id="demandShockValue">0%</div>
                        </div>
                        <div class="slider-group">
                            <label>ä¾›çµ¦ã‚·ãƒ§ãƒƒã‚¯</label>
                            <input type="range" id="supplyShock" min="-20" max="20" value="0" oninput="updateADAS()">
                            <div class="slider-value" id="supplyShockValue">0%</div>
                        </div>
                        <div class="slider-group">
                            <label>æœŸå¾…ã‚¤ãƒ³ãƒ•ãƒ¬ç‡</label>
                            <input type="range" id="expectedInflation" min="0" max="5" value="2" step="0.1" oninput="updateADAS()">
                            <div class="slider-value" id="expectedInflationValue">2.0%</div>
                        </div>
                        <div class="slider-group">
                            <label>è³ƒé‡‘ç¡¬ç›´æ€§</label>
                            <input type="range" id="wageRigidity" min="50" max="150" value="100" oninput="updateADAS()">
                            <div class="slider-value" id="wageRigidityValue">100</div>
                        </div>
                    </div>
                    
                    <div class="interactive-chart">
                        <canvas id="adasChart" width="600" height="400"></canvas>
                    </div>

                    <div class="learning-content">
                        <h4>AD-ASãƒ¢ãƒ‡ãƒ«ã®åŸºæœ¬æ¦‚å¿µ</h4>
                        <p><strong>ADæ›²ç·š</strong>: ç·éœ€è¦ï¼ˆæ¶ˆè²»+æŠ•è³‡+æ”¿åºœæ”¯å‡º+ç´”è¼¸å‡ºï¼‰</p>
                        <p><strong>ASæ›²ç·š</strong>: ç·ä¾›çµ¦ï¼ˆçŸ­æœŸãƒ»é•·æœŸã§ç•°ãªã‚‹å‚¾ãï¼‰</p>
                        <div class="formula">
                            AD: Y = C + I + G + NX<br>
                            SRAS: P = P_e + Î±(Y - Y_n)<br>
                            LRAS: Y = Y_n (æ½œåœ¨GDP)
                        </div>
                    </div>
                </div>
            </div>

            <!-- ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚¿ãƒ– -->
            <div class="tab-content" id="portfolio">
                <div class="tutorial">
                    <h4>ğŸ“š ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªåˆ†æ</h4>
                    <p>ç¾ä»£ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªç†è«–ã«åŸºã¥ã„ã¦ã€ãƒªã‚¹ã‚¯ã¨ãƒªã‚¿ãƒ¼ãƒ³ã‚’æœ€é©åŒ–ã—ãŸæŠ•è³‡æˆ¦ç•¥ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚</p>
                </div>

                <div class="control-panel">
                    <div class="control-row">
                        <div class="control-group">
                            <label>æœ€é©åŒ–ç›®æ¨™</label>
                            <select id="optimizationTarget">
                                <option value="sharpe">ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªæœ€å¤§åŒ–</option>
                                <option value="return">ãƒªã‚¿ãƒ¼ãƒ³æœ€å¤§åŒ–</option>
                                <option value="risk">ãƒªã‚¹ã‚¯æœ€å°åŒ–</option>
                                <option value="utility">åŠ¹ç”¨æœ€å¤§åŒ–</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>åˆ¶ç´„æ¡ä»¶</label>
                            <select id="constraints">
                                <option value="none">åˆ¶ç´„ãªã—</option>
                                <option value="longonly">ãƒ­ãƒ³ã‚°ã‚ªãƒ³ãƒªãƒ¼</option>
                                <option value="maxweight">æœ€å¤§ã‚¦ã‚§ã‚¤ãƒˆåˆ¶é™</option>
                                <option value="sector">ã‚»ã‚¯ã‚¿ãƒ¼åˆ¶é™</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>ãƒªãƒãƒ©ãƒ³ã‚¹é »åº¦</label>
                            <select id="rebalanceFreq">
                                <option value="monthly">æœˆæ¬¡</option>
                                <option value="quarterly">å››åŠæœŸ</option>
                                <option value="yearly">å¹´æ¬¡</option>
                                <option value="threshold">é–¾å€¤ãƒ™ãƒ¼ã‚¹</option>
                            </select>
                        </div>
                        <button class="btn" onclick="optimizePortfolio()">æœ€é©åŒ–å®Ÿè¡Œ</button>
                        <button class="btn secondary" onclick="backtestPortfolio()">ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆ</button>
                    </div>
                </div>

                <div class="portfolio-grid">
                    <div class="asset-list">
                        <h4>è³‡ç”£é¸æŠ</h4>
                        <div class="asset-item selected" data-asset="stocks">
                            <span>å›½å†…æ ªå¼</span>
                            <span>30%</span>
                        </div>
                        <div class="asset-item" data-asset="foreign-stocks">
                            <span>å¤–å›½æ ªå¼</span>
                            <span>25%</span>
                        </div>
                        <div class="asset-item" data-asset="bonds">
                            <span>å›½å†…å‚µåˆ¸</span>
                            <span>20%</span>
                        </div>
                        <div class="asset-item" data-asset="foreign-bonds">
                            <span>å¤–å›½å‚µåˆ¸</span>
                            <span>15%</span>
                        </div>
                        <div class="asset-item" data-asset="reits">
                            <span>ä¸å‹•ç”£æŠ•ä¿¡</span>
                            <span>5%</span>
                        </div>
                        <div class="asset-item" data-asset="commodities">
                            <span>å•†å“</span>
                            <span>3%</span>
                        </div>
                        <div class="asset-item" data-asset="cash">
                            <span>ç¾é‡‘</span>
                            <span>2%</span>
                        </div>
                    </div>

                    <div class="widget">
                        <h3>åŠ¹ç‡çš„ãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢</h3>
                        <div class="chart-container">
                            <canvas id="efficientFrontierChart" width="350" height="300"></canvas>
                        </div>
                    </div>
                </div>

                <div class="risk-metrics">
                    <div class="risk-card">
                        <div class="risk-value">8.5%</div>
                        <div class="risk-label">æœŸå¾…ãƒªã‚¿ãƒ¼ãƒ³</div>
                    </div>
                    <div class="risk-card">
                        <div class="risk-value">12.3%</div>
                        <div class="risk-label">ãƒªã‚¹ã‚¯ï¼ˆæ¨™æº–åå·®ï¼‰</div>
                    </div>
                    <div class="risk-card">
                        <div class="risk-value">0.69</div>
                        <div class="risk-label">ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ª</div>
                    </div>
                    <div class="risk-card">
                        <div class="risk-value">-18.5%</div>
                        <div class="risk-label">VaR (95%)</div>
                    </div>
                    <div class="risk-card">
                        <div class="risk-value">-22.8%</div>
                        <div class="risk-label">æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³</div>
                    </div>
                    <div class="risk-card">
                        <div class="risk-value">1.15</div>
                        <div class="risk-label">æƒ…å ±ãƒ¬ã‚·ã‚ª</div>
                    </div>
                </div>

                <div class="learning-content">
                    <h4>ç¾ä»£ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªç†è«–</h4>
                    <p>ãƒãƒªãƒ¼ãƒ»ãƒãƒ¼ã‚³ã‚¦ã‚£ãƒƒãƒ„ã«ã‚ˆã‚‹ç†è«–ã§ã€ãƒªã‚¹ã‚¯è³‡ç”£ã®çµ„ã¿åˆã‚ã›ã«ã‚ˆã‚Šãƒªã‚¹ã‚¯ã‚’è»½æ¸›ã§ãã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚</p>
                    <div class="formula">
                        E(r_p) = Î£w_i Ã— E(r_i)<br>
                        Ïƒ_pÂ² = Î£w_iÂ² Ã— Ïƒ_iÂ² + Î£Î£w_i Ã— w_j Ã— Ïƒ_ij<br>
                        ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ª = (E(r_p) - r_f) / Ïƒ_p
                    </div>
                </div>
            </div>

            <!-- å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ã‚¿ãƒ– -->
            <div class="tab-content" id="learning">
                <div class="tutorial">
                    <h4>ğŸ“š çµŒæ¸ˆå­¦ãƒ»é‡‘èå­¦å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰</h4>
                    <p>åŸºæœ¬çš„ãªçµŒæ¸ˆç†è«–ã‹ã‚‰é«˜åº¦ãªé‡‘èå·¥å­¦ã¾ã§ã€æ®µéšçš„ã«å­¦ç¿’ã§ãã‚‹åŒ…æ‹¬çš„ãªæ•™è‚²ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚</p>
                </div>

                <div class="control-panel">
                    <div class="control-row">
                        <div class="control-group">
                            <label>å­¦ç¿’åˆ†é‡</label>
                            <select id="learningField" onchange="loadLearningContent()">
                                <option value="macro">ãƒã‚¯ãƒ­çµŒæ¸ˆå­¦</option>
                                <option value="micro">ãƒŸã‚¯ãƒ­çµŒæ¸ˆå­¦</option>
                                <option value="finance">é‡‘èè«–</option>
                                <option value="econometrics">è¨ˆé‡çµŒæ¸ˆå­¦</option>
                                <option value="behavioral">è¡Œå‹•çµŒæ¸ˆå­¦</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>é›£æ˜“åº¦</label>
                            <select id="learningLevel">
                                <option value="beginner">åˆç´š</option>
                                <option value="intermediate">ä¸­ç´š</option>
                                <option value="advanced">ä¸Šç´š</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>å­¦ç¿’å½¢å¼</label>
                            <select id="learningFormat">
                                <option value="theory">ç†è«–å­¦ç¿’</option>
                                <option value="simulation">ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</option>
                                <option value="case">ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£</option>
                                <option value="exercise">æ¼”ç¿’å•é¡Œ</option>
                            </select>
                        </div>
                        <button class="btn" onclick="startLearning()">å­¦ç¿’é–‹å§‹</button>
                        <button class="btn secondary" onclick="checkProgress()">é€²æ—ç¢ºèª</button>
                    </div>
                </div>

                <div id="learningContentArea">
                    <div class="learning-content">
                        <h4>ãƒã‚¯ãƒ­çµŒæ¸ˆå­¦å…¥é–€</h4>
                        <p><strong>GDPï¼ˆå›½å†…ç·ç”Ÿç”£ï¼‰</strong>ã¯ã€ä¸€å®šæœŸé–“å†…ã«å›½å†…ã§ç”Ÿç”£ã•ã‚ŒãŸè²¡ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ã®ç·ä¾¡å€¤ã§ã™ã€‚</p>
                        
                        <h5>GDPã®è¨ˆç®—æ–¹æ³•</h5>
                        <div class="formula">
                            æ”¯å‡ºé¢: GDP = C + I + G + (X - M)<br>
                            C: æ°‘é–“æœ€çµ‚æ¶ˆè²»æ”¯å‡º<br>
                            I: æ°‘é–“è¨­å‚™æŠ•è³‡<br>
                            G: æ”¿åºœæ”¯å‡º<br>
                            X: è¼¸å‡º, M: è¼¸å…¥
                        </div>

                        <h5>ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–æ¼”ç¿’</h5>
                        <p>ä¸‹è¨˜ã®ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚’èª¿æ•´ã—ã¦ã€GDPã®æ§‹æˆè¦ç´ ãŒã©ã®ã‚ˆã†ã«å¤‰åŒ–ã™ã‚‹ã‹ã‚’è¦³å¯Ÿã—ã¦ãã ã•ã„ã€‚</p>
                        
                        <div class="simulation-controls">
                            <div class="slider-group">
                                <label>æ¶ˆè²» (C)</label>
                                <input type="range" id="consumption" min="300" max="400" value="350" oninput="updateGDPComponents()">
                                <div class="slider-value" id="consumptionValue">350å…†å††</div>
                            </div>
                            <div class="slider-group">
                                <label>æŠ•è³‡ (I)</label>
                                <input type="range" id="investment" min="80" max="120" value="100" oninput="updateGDPComponents()">
                                <div class="slider-value" id="investmentValue">100å…†å††</div>
                            </div>
                            <div class="slider-group">
                                <label>æ”¿åºœæ”¯å‡º (G)</label>
                                <input type="range" id="govExpenditure" min="80" max="120" value="100" oninput="updateGDPComponents()">
                                <div class="slider-value" id="govExpenditureValue">100å…†å††</div>
                            </div>
                            <div class="slider-group">
                                <label>ç´”è¼¸å‡º (NX)</label>
                                <input type="range" id="netExports" min="-10" max="10" value="0" oninput="updateGDPComponents()">
                                <div class="slider-value" id="netExportsValue">0å…†å††</div>
                            </div>
                        </div>

                        <div class="chart-container">
                            <canvas id="gdpComponentsChart" width="600" height="250"></canvas>
                        </div>

                        <div class="risk-card" style="margin: 20px 0;">
                            <div class="risk-value" id="totalGDP">550å…†å††</div>
                            <div class="risk-label">ç·GDP</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ã‚¢ãƒ©ãƒ¼ãƒˆã‚¿ãƒ– -->
            <div class="tab-content" id="alerts">
                <div class="tutorial">
                    <h4>ğŸ“š ã‚¢ãƒ©ãƒ¼ãƒˆç®¡ç†</h4>
                    <p>çµŒæ¸ˆæŒ‡æ¨™ã‚„å¸‚å ´ä¾¡æ ¼ã®å¤‰å‹•ã‚’ç›£è¦–ã—ã€è¨­å®šã—ãŸæ¡ä»¶ã«åŸºã¥ã„ã¦ã‚¢ãƒ©ãƒ¼ãƒˆã‚’å—ã‘å–ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
                </div>

                <div class="control-panel">
                    <div class="control-row">
                        <div class="control-group">
                            <label>ã‚¢ãƒ©ãƒ¼ãƒˆã‚¿ã‚¤ãƒ—</label>
                            <select id="alertType">
                                <option value="price">ä¾¡æ ¼ã‚¢ãƒ©ãƒ¼ãƒˆ</option>
                                <option value="change">å¤‰å‹•ç‡ã‚¢ãƒ©ãƒ¼ãƒˆ</option>
                                <option value="technical">ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«ã‚¢ãƒ©ãƒ¼ãƒˆ</option>
                                <option value="economic">çµŒæ¸ˆæŒ‡æ¨™ã‚¢ãƒ©ãƒ¼ãƒˆ</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>ç›£è¦–å¯¾è±¡</label>
                            <select id="alertTarget">
                                <option value="nikkei">æ—¥çµŒå¹³å‡</option>
                                <option value="usdjpy">USD/JPY</option>
                                <option value="cpi">æ¶ˆè²»è€…ç‰©ä¾¡æŒ‡æ•°</option>
                                <option value="gdp">GDPæˆé•·ç‡</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>æ¡ä»¶</label>
                            <select id="alertCondition">
                                <option value="above">ä»¥ä¸Š</option>
                                <option value="below">ä»¥ä¸‹</option>
                                <option value="change">å¤‰åŒ–ç‡</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>é–¾å€¤</label>
                            <input type="number" id="alertThreshold" placeholder="æ•°å€¤ã‚’å…¥åŠ›">
                        </div>
                        <button class="btn" onclick="addAlert()">ã‚¢ãƒ©ãƒ¼ãƒˆè¿½åŠ </button>
                    </div>
                </div>

                <div class="alert-panel">
                    <h3>ğŸ”” ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¢ãƒ©ãƒ¼ãƒˆ</h3>
                    <div class="alert-item">
                        <div class="alert-message">æ—¥çµŒå¹³å‡ãŒ40,000å††ã‚’è¶…é</div>
                        <div class="alert-time">2025-07-28 15:30</div>
                    </div>
                    <div class="alert-item">
                        <div class="alert-message">USD/JPYãŒ155å††ã«æ¥è¿‘</div>
                        <div class="alert-time">2025-07-28 14:45</div>
                    </div>
                    <div class="alert-item">
                        <div class="alert-message">æ—¥éŠ€æ”¿ç­–é‡‘åˆ©å¤‰æ›´ã®å¯èƒ½æ€§</div>
                        <div class="alert-time">2025-07-28 13:20</div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="widget">
                        <h3>ğŸ“Š ã‚¢ãƒ©ãƒ¼ãƒˆçµ±è¨ˆ</h3>
                        <div class="risk-metrics">
                            <div class="risk-card">
                                <div class="risk-value">15</div>
                                <div class="risk-label">ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¢ãƒ©ãƒ¼ãƒˆ</div>
                            </div>
                            <div class="risk-card">
                                <div class="risk-value">142</div>
                                <div class="risk-label">ä»Šæœˆã®é€šçŸ¥æ•°</div>
                            </div>
                            <div class="risk-card">
                                <div class="risk-value">85%</div>
                                <div class="risk-label">çš„ä¸­ç‡</div>
                            </div>
                        </div>
                    </div>

                    <div class="widget">
                        <h3>ğŸ“ˆ ã‚¢ãƒ©ãƒ¼ãƒˆå±¥æ­´</h3>
                        <div class="chart-container">
                            <canvas id="alertHistoryChart" width="300" height="200"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let dashboardData = {
            marketData: new Map(),
            economicIndicators: new Map(),
            portfolioWeights: new Map(),
            alertsActive: [],
            updateInterval: null
        };

        let simulationState = {
            islm: {
                govSpending: 100,
                taxRate: 25,
                moneySupply: 100,
                investSensitivity: 100
            },
            adas: {
                demandShock: 0,
                supplyShock: 0,
                expectedInflation: 2.0,
                wageRigidity: 100
            }
        };

        // ãƒãƒ£ãƒ¼ãƒˆæç”»ç”¨ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
        let chartContexts = new Map();

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeTabs();
            initializeCharts();
            loadMarketData();
            startDataUpdates();
            initializePortfolioData();
            initializeSimulations();
        });

        // ã‚¿ãƒ–æ©Ÿèƒ½
        function initializeTabs() {
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(tc => tc.classList.remove('active'));
                    
                    tab.classList.add('active');
                    document.getElementById(tab.dataset.tab).classList.add('active');
                    
                    // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ™‚ã®å‡¦ç†
                    onTabSwitch(tab.dataset.tab);
                });
            });
        }

        function onTabSwitch(tabId) {
            switch(tabId) {
                case 'markets':
                    updateMarketChart();
                    break;
                case 'simulation':
                    updateISLM();
                    updateADAS();
                    break;
                case 'portfolio':
                    drawEfficientFrontier();
                    break;
            }
        }

        // ãƒãƒ£ãƒ¼ãƒˆåˆæœŸåŒ–
        function initializeCharts() {
            // ä¸»è¦ãƒãƒ£ãƒ¼ãƒˆã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
            const chartIds = [
                'marketTrendChart', 'internationalChart', 'economicIndicatorChart',
                'marketChart', 'marketStatsChart', 'sectorChart', 'islmChart',
                'adasChart', 'efficientFrontierChart', 'gdpComponentsChart', 'alertHistoryChart'
            ];

            chartIds.forEach(id => {
                const canvas = document.getElementById(id);
                if (canvas) {
                    chartContexts.set(id, canvas.getContext('2d'));
                }
            });

            // åˆæœŸãƒãƒ£ãƒ¼ãƒˆæç”»
            drawMarketTrendChart();
            drawInternationalChart();
            drawCorrelationMatrix();
            drawGDPComponentsChart();
        }

        // å¸‚å ´ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
        function loadMarketData() {
            // æ¨¡æ“¬ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆ
            const markets = ['nikkei', 'topix', 'usdjpy', 'bond10y', 'wti', 'gold'];
            
            markets.forEach(market => {
                dashboardData.marketData.set(market, generateMarketData(market));
            });

            updateMarketSummary();
        }

        function generateMarketData(market) {
            const baseValues = {
                nikkei: 39580,
                topix: 2785,
                usdjpy: 154.25,
                bond10y: 0.825,
                wti: 72.45,
                gold: 2415.30
            };

            const data = [];
            const baseValue = baseValues[market] || 100;
            
            for (let i = 0; i < 100; i++) {
                const time = new Date(Date.now() - (100 - i) * 60000); // 1åˆ†é–“éš”
                const randomChange = (Math.random() - 0.5) * 0.02; // Â±1%ã®å¤‰å‹•
                const value = baseValue * (1 + randomChange * i * 0.1);
                
                data.push({
                    time: time,
                    value: value,
                    change: i > 0 ? value - data[i-1].value : 0
                });
            }
            
            return data;
        }

        function updateMarketSummary() {
            // å¸‚å ´ã‚µãƒãƒªãƒ¼ã®æ›´æ–°ï¼ˆå®Ÿéš›ã®APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹å ´åˆã¯ã“ã“ã‚’ä¿®æ­£ï¼‰
            const summaryCards = document.querySelectorAll('.market-card');
            
            summaryCards.forEach(card => {
                const priceElement = card.querySelector('.market-price');
                const changeElement = card.querySelector('.market-change');
                
                // ãƒ©ãƒ³ãƒ€ãƒ ãªä¾¡æ ¼å¤‰å‹•ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                const currentPrice = parseFloat(priceElement.textContent.replace(/[^\d.-]/g, ''));
                const change = (Math.random() - 0.5) * currentPrice * 0.01;
                const newPrice = currentPrice + change;
                const changePercent = (change / currentPrice * 100);
                
                priceElement.textContent = newPrice.toFixed(2);
                changeElement.textContent = `${change >= 0 ? '+' : ''}${change.toFixed(2)} (${changePercent >= 0 ? '+' : ''}${changePercent.toFixed(2)}%)`;
                changeElement.className = `market-change ${change >= 0 ? 'positive' : 'negative'}`;
                priceElement.style.color = change >= 0 ? '#28a745' : '#dc3545';
            });
        }

        // ãƒãƒ£ãƒ¼ãƒˆæç”»é–¢æ•°
        function drawMarketTrendChart() {
            const ctx = chartContexts.get('marketTrendChart');
            if (!ctx) return;

            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
            
            // ç°¡å˜ãªç·šã‚°ãƒ©ãƒ•ã‚’æç”»
            const data = Array.from({length: 20}, (_, i) => ({
                x: i * (ctx.canvas.width / 19),
                y: ctx.canvas.height/2 + Math.sin(i * 0.3) * 50 + (Math.random() - 0.5) * 20
            }));

            ctx.strokeStyle = '#007bff';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            data.forEach((point, i) => {
                if (i === 0) {
                    ctx.moveTo(point.x, point.y);
                } else {
                    ctx.lineTo(point.x, point.y);
                }
            });
            
            ctx.stroke();

            // ã‚°ãƒªãƒƒãƒ‰ç·š
            ctx.strokeStyle = '#e9ecef';
            ctx.lineWidth = 1;
            
            for (let i = 0; i <= 4; i++) {
                const y = (ctx.canvas.height / 4) * i;
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(ctx.canvas.width, y);
                ctx.stroke();
            }
        }

        function drawInternationalChart() {
            const ctx = chartContexts.get('internationalChart');
            if (!ctx) return;

            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
            
            const countries = ['Japan', 'USA', 'EU', 'China'];
            const colors = ['#007bff', '#28a745', '#ffc107', '#dc3545'];
            const barWidth = ctx.canvas.width / countries.length - 10;
            
            countries.forEach((country, i) => {
                const height = Math.random() * ctx.canvas.height * 0.7 + 20;
                const x = i * (barWidth + 10) + 5;
                const y = ctx.canvas.height - height;
                
                ctx.fillStyle = colors[i];
                ctx.fillRect(x, y, barWidth, height);
                
                // ãƒ©ãƒ™ãƒ«
                ctx.fillStyle = '#495057';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(country, x + barWidth/2, ctx.canvas.height - 5);
            });
        }

        function drawCorrelationMatrix() {
            const container = document.getElementById('correlationMatrix');
            if (!container) return;

            const assets = ['æ ªå¼', 'å‚µåˆ¸', 'ç‚ºæ›¿', 'å•†å“', 'REIT', 'ç¾é‡‘'];
            
            container.innerHTML = '';
            
            assets.forEach((asset1, i) => {
                assets.forEach((asset2, j) => {
                    const cell = document.createElement('div');
                    cell.className = 'correlation-cell';
                    
                    let correlation;
                    if (i === j) {
                        correlation = 1.0;
                    } else {
                        correlation = (Math.random() - 0.5) * 2; // -1 to 1
                    }
                    
                    cell.textContent = correlation.toFixed(2);
                    
                    // è‰²åˆ†ã‘
                    const intensity = Math.abs(correlation);
                    if (correlation > 0) {
                        cell.style.backgroundColor = `rgba(40, 167, 69, ${intensity})`;
                    } else {
                        cell.style.backgroundColor = `rgba(220, 53, 69, ${intensity})`;
                    }
                    
                    container.appendChild(cell);
                });
            });
        }

        // IS-LMåˆ†æ
        function updateISLM() {
            const govSpending = document.getElementById('govSpending').value;
            const taxRate = document.getElementById('taxRate').value;
            const moneySupply = document.getElementById('moneySupply').value;
            const investSensitivity = document.getElementById('investSensitivity').value;

            // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã®å€¤ã‚’è¡¨ç¤º
            document.getElementById('govSpendingValue').textContent = govSpending;
            document.getElementById('taxRateValue').textContent = taxRate + '%';
            document.getElementById('moneySupplyValue').textContent = moneySupply;
            document.getElementById('investSensitivityValue').textContent = investSensitivity;

            // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹æ›´æ–°
            simulationState.islm = {
                govSpending: parseInt(govSpending),
                taxRate: parseInt(taxRate),
                moneySupply: parseInt(moneySupply),
                investSensitivity: parseInt(investSensitivity)
            };

            drawISLMChart();
        }

        function drawISLMChart() {
            const ctx = chartContexts.get('islmChart');
            if (!ctx) return;

            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
            
            const width = ctx.canvas.width;
            const height = ctx.canvas.height;
            const margin = 50;

            // è»¸ã®æç”»
            ctx.strokeStyle = '#495057';
            ctx.lineWidth = 2;
            
            // Yè»¸ï¼ˆåˆ©å­ç‡ï¼‰
            ctx.beginPath();
            ctx.moveTo(margin, margin);
            ctx.lineTo(margin, height - margin);
            ctx.stroke();
            
            // Xè»¸ï¼ˆGDPï¼‰
            ctx.beginPath();
            ctx.moveTo(margin, height - margin);
            ctx.lineTo(width - margin, height - margin);
            ctx.stroke();

            // ãƒ©ãƒ™ãƒ«
            ctx.fillStyle = '#495057';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('GDP (Y)', width/2, height - 10);
            
            ctx.save();
            ctx.translate(20, height/2);
            ctx.rotate(-Math.PI/2);
            ctx.fillText('åˆ©å­ç‡ (r)', 0, 0);
            ctx.restore();

            // ISæ›²ç·šã®æç”»
            const state = simulationState.islm;
            ctx.strokeStyle = '#007bff';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            for (let x = margin; x < width - margin; x += 5) {
                const gdp = (x - margin) / (width - 2*margin) * 1000;
                const interestRate = calculateISCurve(gdp, state);
                const y = height - margin - (interestRate / 10) * (height - 2*margin);
                
                if (x === margin) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();

            // LMæ›²ç·šã®æç”»
            ctx.strokeStyle = '#dc3545';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            for (let x = margin; x < width - margin; x += 5) {
                const gdp = (x - margin) / (width - 2*margin) * 1000;
                const interestRate = calculateLMCurve(gdp, state);
                const y = height - margin - (interestRate / 10) * (height - 2*margin);
                
                if (x === margin) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();

            // å‡¡ä¾‹
            ctx.fillStyle = '#007bff';
            ctx.fillRect(width - 150, 20, 20, 15);
            ctx.fillStyle = '#495057';
            ctx.font = '12px Arial';
            ctx.fillText('ISæ›²ç·š', width - 120, 32);
            
            ctx.fillStyle = '#dc3545';
            ctx.fillRect(width - 150, 40, 20, 15);
            ctx.fillStyle = '#495057';
            ctx.fillText('LMæ›²ç·š', width - 120, 52);
        }

        function calculateISCurve(gdp, state) {
            // ç°¡åŒ–ã•ã‚ŒãŸISæ›²ç·š: r = a - b*Y + c*G - d*t
            const a = 8;
            const b = 0.005;
            const c = 0.01;
            const d = 0.05;
            
            return Math.max(0, a - b * gdp + c * state.govSpending - d * state.taxRate);
        }

        function calculateLMCurve(gdp, state) {
            // ç°¡åŒ–ã•ã‚ŒãŸLMæ›²ç·š: r = e*Y - f*M
            const e = 0.008;
            const f = 0.05;
            
            return Math.max(0, e * gdp - f * state.moneySupply);
        }

        // AD-ASåˆ†æ
        function updateADAS() {
            const demandShock = document.getElementById('demandShock').value;
            const supplyShock = document.getElementById('supplyShock').value;
            const expectedInflation = document.getElementById('expectedInflation').value;
            const wageRigidity = document.getElementById('wageRigidity').value;

            // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã®å€¤ã‚’è¡¨ç¤º
            document.getElementById('demandShockValue').textContent = demandShock + '%';
            document.getElementById('supplyShockValue').textContent = supplyShock + '%';
            document.getElementById('expectedInflationValue').textContent = expectedInflation + '%';
            document.getElementById('wageRigidityValue').textContent = wageRigidity;

            simulationState.adas = {
                demandShock: parseFloat(demandShock),
                supplyShock: parseFloat(supplyShock),
                expectedInflation: parseFloat(expectedInflation),
                wageRigidity: parseInt(wageRigidity)
            };

            drawADASChart();
        }

        function drawADASChart() {
            const ctx = chartContexts.get('adasChart');
            if (!ctx) return;

            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
            
            const width = ctx.canvas.width;
            const height = ctx.canvas.height;
            const margin = 50;

            // è»¸ã®æç”»
            ctx.strokeStyle = '#495057';
            ctx.lineWidth = 2;
            
            ctx.beginPath();
            ctx.moveTo(margin, margin);
            ctx.lineTo(margin, height - margin);
            ctx.moveTo(margin, height - margin);
            ctx.lineTo(width - margin, height - margin);
            ctx.stroke();

            // ãƒ©ãƒ™ãƒ«
            ctx.fillStyle = '#495057';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('GDP (Y)', width/2, height - 10);
            
            ctx.save();
            ctx.translate(20, height/2);
            ctx.rotate(-Math.PI/2);
            ctx.fillText('ç‰©ä¾¡æ°´æº– (P)', 0, 0);
            ctx.restore();

            const state = simulationState.adas;

            // ADæ›²ç·š
            ctx.strokeStyle = '#007bff';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            for (let x = margin; x < width - margin; x += 5) {
                const gdp = (x - margin) / (width - 2*margin) * 1000;
                const price = calculateADCurve(gdp, state);
                const y = height - margin - (price / 5) * (height - 2*margin);
                
                if (x === margin) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();

            // SRASæ›²ç·š
            ctx.strokeStyle = '#28a745';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            for (let x = margin; x < width - margin; x += 5) {
                const gdp = (x - margin) / (width - 2*margin) * 1000;
                const price = calculateSRASCurve(gdp, state);
                const y = height - margin - (price / 5) * (height - 2*margin);
                
                if (x === margin) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();

            // LRASæ›²ç·š
            ctx.strokeStyle = '#ffc107';
            ctx.lineWidth = 3;
            ctx.setLineDash([10, 10]);
            ctx.beginPath();
            const lrasX = margin + (width - 2*margin) * 0.6; // æ½œåœ¨GDPä½ç½®
            ctx.moveTo(lrasX, margin);
            ctx.lineTo(lrasX, height - margin);
            ctx.stroke();
            ctx.setLineDash([]);

            // å‡¡ä¾‹
            const legendY = 20;
            ctx.fillStyle = '#007bff';
            ctx.fillRect(width - 150, legendY, 20, 15);
            ctx.fillStyle = '#495057';
            ctx.font = '12px Arial';
            ctx.fillText('ADæ›²ç·š', width - 120, legendY + 12);
            
            ctx.fillStyle = '#28a745';
            ctx.fillRect(width - 150, legendY + 20, 20, 15);
            ctx.fillText('SRASæ›²ç·š', width - 120, legendY + 32);
            
            ctx.fillStyle = '#ffc107';
            ctx.fillRect(width - 150, legendY + 40, 20, 15);
            ctx.fillText('LRASæ›²ç·š', width - 120, legendY + 52);
        }

        function calculateADCurve(gdp, state) {
            // ADæ›²ç·š: P = a - b*Y + shock
            const a = 4;
            const b = 0.003;
            return Math.max(0.5, a - b * gdp + state.demandShock * 0.1);
        }

        function calculateSRASCurve(gdp, state) {
            // SRASæ›²ç·š: P = Pe + c*(Y - Yn) + supply_shock
            const naturalGDP = 600;
            const c = 0.005;
            return Math.max(0.5, state.expectedInflation + c * (gdp - naturalGDP) + state.supplyShock * 0.1);
        }

        // ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªé–¢æ•°
        function initializePortfolioData() {
            const assets = ['stocks', 'foreign-stocks', 'bonds', 'foreign-bonds', 'reits', 'commodities', 'cash'];
            const weights = [30, 25, 20, 15, 5, 3, 2];
            
            assets.forEach((asset, i) => {
                dashboardData.portfolioWeights.set(asset, weights[i]);
            });

            setupAssetSelection();
        }

        function setupAssetSelection() {
            const assetItems = document.querySelectorAll('.asset-item');
            
            assetItems.forEach(item => {
                item.addEventListener('click', function() {
                    assetItems.forEach(i => i.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    // é¸æŠã•ã‚ŒãŸè³‡ç”£ã®è©³ç´°ã‚’è¡¨ç¤ºï¼ˆå®Ÿè£…å¯èƒ½ï¼‰
                });
            });
        }

        function drawEfficientFrontier() {
            const ctx = chartContexts.get('efficientFrontierChart');
            if (!ctx) return;

            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
            
            const width = ctx.canvas.width;
            const height = ctx.canvas.height;
            const margin = 30;

            // è»¸
            ctx.strokeStyle = '#495057';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(margin, height - margin);
            ctx.lineTo(width - margin, height - margin);
            ctx.moveTo(margin, height - margin);
            ctx.lineTo(margin, margin);
            ctx.stroke();

            // åŠ¹ç‡çš„ãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢
            ctx.strokeStyle = '#007bff';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            for (let i = 0; i <= 50; i++) {
                const risk = 5 + i * 0.5; // 5% - 30%ã®ãƒªã‚¹ã‚¯
                const expectedReturn = Math.sqrt(risk) * 2.2 + 2; // ãƒªã‚¹ã‚¯ã«å¿œã˜ãŸãƒªã‚¿ãƒ¼ãƒ³
                
                const x = margin + (risk / 30) * (width - 2*margin);
                const y = height - margin - (expectedReturn / 15) * (height - 2*margin);
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();

            // ç¾åœ¨ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª
            ctx.fillStyle = '#dc3545';
            ctx.beginPath();
            ctx.arc(margin + (12.3 / 30) * (width - 2*margin), 
                   height - margin - (8.5 / 15) * (height - 2*margin), 5, 0, 2*Math.PI);
            ctx.fill();

            // ãƒ©ãƒ™ãƒ«
            ctx.fillStyle = '#495057';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('ãƒªã‚¹ã‚¯ (%)', width/2, height - 5);
            
            ctx.save();
            ctx.translate(15, height/2);
            ctx.rotate(-Math.PI/2);
            ctx.fillText('æœŸå¾…ãƒªã‚¿ãƒ¼ãƒ³ (%)', 0, 0);
            ctx.restore();
        }

        // GDPæ§‹æˆè¦ç´ ãƒãƒ£ãƒ¼ãƒˆ
        function updateGDPComponents() {
            const consumption = document.getElementById('consumption').value;
            const investment = document.getElementById('investment').value;
            const govExpenditure = document.getElementById('govExpenditure').value;
            const netExports = document.getElementById('netExports').value;

            // å€¤ã®æ›´æ–°
            document.getElementById('consumptionValue').textContent = consumption + 'å…†å††';
            document.getElementById('investmentValue').textContent = investment + 'å…†å††';
            document.getElementById('govExpenditureValue').textContent = govExpenditure + 'å…†å††';
            document.getElementById('netExportsValue').textContent = netExports + 'å…†å††';

            const totalGDP = parseInt(consumption) + parseInt(investment) + 
                           parseInt(govExpenditure) + parseInt(netExports);
            document.getElementById('totalGDP').textContent = totalGDP + 'å…†å††';

            drawGDPComponentsChart();
        }

        function drawGDPComponentsChart() {
            const ctx = chartContexts.get('gdpComponentsChart');
            if (!ctx) return;

            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
            
            const consumption = parseInt(document.getElementById('consumption')?.value || 350);
            const investment = parseInt(document.getElementById('investment')?.value || 100);
            const govExpenditure = parseInt(document.getElementById('govExpenditure')?.value || 100);
            const netExports = parseInt(document.getElementById('netExports')?.value || 0);

            const components = [
                {name: 'æ¶ˆè²» (C)', value: consumption, color: '#007bff'},
                {name: 'æŠ•è³‡ (I)', value: investment, color: '#28a745'},
                {name: 'æ”¿åºœæ”¯å‡º (G)', value: govExpenditure, color: '#ffc107'},
                {name: 'ç´”è¼¸å‡º (NX)', value: netExports, color: '#dc3545'}
            ];

            const total = consumption + investment + govExpenditure + netExports;
            const width = ctx.canvas.width;
            const height = ctx.canvas.height;
            
            let currentX = 0;
            
            components.forEach(component => {
                const barWidth = (Math.abs(component.value) / Math.abs(total)) * width;
                
                ctx.fillStyle = component.color;
                ctx.fillRect(currentX, height/2 - 30, barWidth, 60);
                
                // ãƒ©ãƒ™ãƒ«
                ctx.fillStyle = 'white';
                ctx.font = '14px Arial';
                ctx.textAlign = 'center';
                if (barWidth > 50) {
                    ctx.fillText(component.name, currentX + barWidth/2, height/2 - 5);
                    ctx.fillText(component.value + 'å…†å††', currentX + barWidth/2, height/2 + 15);
                }
                
                currentX += barWidth;
            });
        }

        // ãƒ‡ãƒ¼ã‚¿æ›´æ–°é–¢æ•°
        function startDataUpdates() {
            const interval = parseInt(document.getElementById('updateInterval')?.value || 5) * 1000;
            
            if (dashboardData.updateInterval) {
                clearInterval(dashboardData.updateInterval);
            }
            
            dashboardData.updateInterval = setInterval(() => {
                updateMarketSummary();
                updateCharts();
            }, interval);
        }

        function updateCharts() {
            // ãƒãƒ£ãƒ¼ãƒˆã®æ›´æ–°ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
            if (document.querySelector('.tab[data-tab="dashboard"]').classList.contains('active')) {
                drawMarketTrendChart();
            }
        }

        function refreshAllData() {
            loadMarketData();
            updateMarketSummary();
            updateCharts();
            
            // æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            showNotification('ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ã—ã¾ã—ãŸ', 'success');
        }

        // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `alert-panel ${type}`;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '1000';
            notification.style.minWidth = '300px';
            
            notification.innerHTML = `
                <div class="alert-item">
                    <div class="alert-message">${message}</div>
                    <div class="alert-time">${new Date().toLocaleTimeString()}</div>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // APIé–¢æ•°ï¼ˆå®Ÿè£…ä¾‹ï¼‰
        function updateEconomicChart() {
            showNotification('çµŒæ¸ˆæŒ‡æ¨™ãƒãƒ£ãƒ¼ãƒˆã‚’æ›´æ–°ä¸­...', 'info');
            // å®Ÿéš›ã®APIå‘¼ã³å‡ºã—ã¯ã“ã“ã«å®Ÿè£…
        }

        function compareCountries() {
            showNotification('å›½éš›æ¯”è¼ƒãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ä¸­...', 'info');
        }

        function updateMarketChart() {
            showNotification('å¸‚å ´ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ä¸­...', 'info');
        }

        function addTechnicalIndicator() {
            showNotification('ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™ã‚’è¿½åŠ ã—ã¾ã—ãŸ', 'success');
        }

        function optimizePortfolio() {
            showNotification('ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªæœ€é©åŒ–ã‚’å®Ÿè¡Œä¸­...', 'info');
            
            setTimeout(() => {
                showNotification('æœ€é©åŒ–ãŒå®Œäº†ã—ã¾ã—ãŸ', 'success');
                drawEfficientFrontier();
            }, 2000);
        }

        function backtestPortfolio() {
            showNotification('ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œä¸­...', 'info');
        }

        function addAlert() {
            const alertType = document.getElementById('alertType')?.value;
            const alertTarget = document.getElementById('alertTarget')?.value;
            const alertCondition = document.getElementById('alertCondition')?.value;
            const alertThreshold = document.getElementById('alertThreshold')?.value;
            
            if (!alertThreshold) {
                showNotification('é–¾å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                return;
            }
            
            dashboardData.alertsActive.push({
                type: alertType,
                target: alertTarget,
                condition: alertCondition,
                threshold: parseFloat(alertThreshold),
                created: new Date()
            });
            
            showNotification('ã‚¢ãƒ©ãƒ¼ãƒˆã‚’è¿½åŠ ã—ã¾ã—ãŸ', 'success');
        }

        function exportData() {
            showNotification('ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆä¸­...', 'info');
            
            const data = {
                marketData: Object.fromEntries(dashboardData.marketData),
                economicIndicators: Object.fromEntries(dashboardData.economicIndicators),
                portfolioWeights: Object.fromEntries(dashboardData.portfolioWeights),
                exportTime: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `economic_data_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ', 'success');
        }

        // å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰é–¢æ•°
        function loadLearningContent() {
            const field = document.getElementById('learningField')?.value;
            showNotification(`${field}ã®å­¦ç¿’ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’èª­ã¿è¾¼ã¿ä¸­...`, 'info');
        }

        function startLearning() {
            showNotification('å­¦ç¿’ã‚’é–‹å§‹ã—ã¾ã™', 'success');
        }

        function checkProgress() {
            showNotification('å­¦ç¿’é€²æ—: 65% å®Œäº†', 'info');
        }

        // ãƒãƒ£ãƒ¼ãƒˆæ“ä½œé–¢æ•°
        function addTrendline() {
            showNotification('ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’è¿½åŠ ã—ã¾ã—ãŸ', 'success');
        }

        function addMovingAverage() {
            showNotification('ç§»å‹•å¹³å‡ç·šã‚’è¿½åŠ ã—ã¾ã—ãŸ', 'success');
        }

        function detectCycles() {
            showNotification('çµŒæ¸ˆã‚µã‚¤ã‚¯ãƒ«ã‚’æ¤œå‡ºä¸­...', 'info');
        }

        function exportChart() {
            showNotification('ãƒãƒ£ãƒ¼ãƒˆã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'success');
        }

        function addMA(period) {
            showNotification(`MA${period}ã‚’è¿½åŠ ã—ã¾ã—ãŸ`, 'success');
        }

        function addBollinger() {
            showNotification('ãƒœãƒªãƒ³ã‚¸ãƒ£ãƒ¼ãƒãƒ³ãƒ‰ã‚’è¿½åŠ ã—ã¾ã—ãŸ', 'success');
        }

        function addRSI() {
            showNotification('RSIã‚’è¿½åŠ ã—ã¾ã—ãŸ', 'success');
        }

        function addMACD() {
            showNotification('MACDã‚’è¿½åŠ ã—ã¾ã—ãŸ', 'success');
        }

        // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        window.addEventListener('error', function(event) {
            console.error('ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼:', event.error);
            showNotification('äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ', 'error');
        });

        // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–
        let performanceMetrics = {
            chartRenderTime: 0,
            dataUpdateTime: 0,
            lastUpdate: null
        };

        function measurePerformance(operation, func) {
            const start = performance.now();
            const result = func();
            const end = performance.now();
            
            performanceMetrics[operation + 'Time'] = end - start;
            performanceMetrics.lastUpdate = new Date();
            
            return result;
        }

        // ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ
        function handleResize() {
            // ãƒãƒ£ãƒ¼ãƒˆã®ãƒªã‚µã‚¤ã‚ºå‡¦ç†
            setTimeout(() => {
                Object.keys(chartContexts).forEach(chartId => {
                    const canvas = document.getElementById(chartId);
                    if (canvas && canvas.offsetParent !== null) {
                        // ãƒãƒ£ãƒ¼ãƒˆã®å†æç”»
                        switch(chartId) {
                            case 'marketTrendChart':
                                drawMarketTrendChart();
                                break;
                            case 'internationalChart':
                                drawInternationalChart();
                                break;
                            case 'islmChart':
                                drawISLMChart();
                                break;
                            case 'adasChart':
                                drawADASChart();
                                break;
                            case 'efficientFrontierChart':
                                drawEfficientFrontier();
                                break;
                            case 'gdpComponentsChart':
                                drawGDPComponentsChart();
                                break;
                        }
                    }
                });
            }, 250);
        }

        window.addEventListener('resize', handleResize);

        // åˆæœŸãƒ‡ãƒ¼ã‚¿è¨­å®š
        function initializeSimulations() {
            // IS-LMã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–
            updateISLM();
            
            // AD-ASã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–
            updateADAS();
            
            // GDPæ§‹æˆè¦ç´ åˆæœŸåŒ–
            updateGDPComponents();
        }

        // è‡ªå‹•ä¿å­˜æ©Ÿèƒ½
        function autoSave() {
            const data = {
                dashboardSettings: {
                    updateInterval: document.getElementById('updateInterval')?.value,
                    timeRange: document.getElementById('timeRange')?.value
                },
                portfolioWeights: Object.fromEntries(dashboardData.portfolioWeights),
                alerts: dashboardData.alertsActive,
                timestamp: new Date().toISOString()
            };
            
            try {
                localStorage.setItem('economicDashboardData', JSON.stringify(data));
            } catch (e) {
                console.warn('è‡ªå‹•ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ:', e);
            }
        }

        function autoLoad() {
            try {
                const saved = localStorage.getItem('economicDashboardData');
                if (saved) {
                    const data = JSON.parse(saved);
                    // è¨­å®šã®å¾©å…ƒå‡¦ç†ã‚’ã“ã“ã«å®Ÿè£…
                }
            } catch (e) {
                console.warn('è‡ªå‹•èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:', e);
            }
        }

        // å®šæœŸçš„ãªè‡ªå‹•ä¿å­˜
        setInterval(autoSave, 60000); // 1åˆ†ã”ã¨

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®è‡ªå‹•å¾©å…ƒ
        document.addEventListener('DOMContentLoaded', autoLoad);
    </script>
</body>
</html>