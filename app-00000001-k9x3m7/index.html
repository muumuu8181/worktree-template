<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ‡ãƒ¼ã‚¿æ§‹é€ ãƒ»ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å¯è¦–åŒ–ãƒ„ãƒ¼ãƒ«</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2563eb;
            --secondary-color: #1d4ed8;
            --accent-color: #3b82f6;
            --background-color: #f8fafc;
            --surface-color: #ffffff;
            --text-color: #1f2937;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        [data-theme="dark"] {
            --background-color: #0f172a;
            --surface-color: #1e293b;
            --text-color: #f8fafc;
            --text-secondary: #cbd5e1;
            --border-color: #334155;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px 0;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            color: white;
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background-color: var(--surface-color);
            border-radius: 12px;
            padding: 8px;
            box-shadow: var(--shadow-md);
            overflow-x: auto;
        }

        .tab-button {
            padding: 12px 24px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            white-space: nowrap;
            min-width: 120px;
        }

        .tab-button:hover {
            background-color: var(--primary-color);
            color: white;
        }

        .tab-button.active {
            background-color: var(--primary-color);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .tab-content {
            display: none;
            background-color: var(--surface-color);
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--shadow-md);
            min-height: 600px;
        }

        .tab-content.active {
            display: block;
        }

        .control-panel {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 25px;
            padding: 20px;
            background-color: var(--background-color);
            border-radius: 12px;
            border: 1px solid var(--border-color);
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .control-group label {
            font-weight: 500;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .control-input {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background-color: var(--surface-color);
            color: var(--text-color);
            font-size: 0.9rem;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--secondary-color);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background-color: var(--text-secondary);
            color: white;
        }

        .btn-secondary:hover {
            background-color: var(--text-color);
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }

        .visualization-area {
            background-color: var(--surface-color);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .data-structure-canvas {
            width: 100%;
            height: 400px;
            background: linear-gradient(45deg, #f0f9ff 25%, transparent 25%),
                        linear-gradient(-45deg, #f0f9ff 25%, transparent 25%),
                        linear-gradient(45deg, transparent 75%, #f0f9ff 75%),
                        linear-gradient(-45deg, transparent 75%, #f0f9ff 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
        }

        .array-element {
            display: inline-block;
            width: 60px;
            height: 60px;
            border: 2px solid var(--primary-color);
            background-color: var(--surface-color);
            margin: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border-radius: 8px;
            transition: all 0.3s ease;
            position: relative;
        }

        .array-element.active {
            background-color: var(--primary-color);
            color: white;
            transform: scale(1.1);
        }

        .array-element.comparing {
            border-color: var(--warning-color);
            background-color: var(--warning-color);
            color: white;
        }

        .array-element.sorted {
            border-color: var(--success-color);
            background-color: var(--success-color);
            color: white;
        }

        .array-index {
            position: absolute;
            top: -25px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .node {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            position: absolute;
            transition: all 0.5s ease;
        }

        .node.visited {
            background-color: var(--success-color);
        }

        .node.current {
            background-color: var(--warning-color);
            transform: scale(1.2);
        }

        .edge {
            position: absolute;
            background-color: var(--text-secondary);
            transform-origin: left center;
            transition: all 0.3s ease;
        }

        .edge.active {
            background-color: var(--primary-color);
            height: 4px !important;
        }

        .stats-panel {
            background-color: var(--background-color);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background-color: var(--surface-color);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .explanation-panel {
            background-color: var(--background-color);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid var(--primary-color);
        }

        .code-block {
            background-color: #1e293b;
            color: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 15px 0;
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .speed-slider {
            width: 150px;
        }

        .algorithm-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .algorithm-card {
            padding: 20px;
            background-color: var(--surface-color);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .algorithm-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .algorithm-card.selected {
            border-color: var(--primary-color);
            background-color: var(--primary-color);
            color: white;
        }

        .complexity-badge {
            display: inline-block;
            background-color: var(--accent-color);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
            margin-top: 5px;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
        }

        .log-output {
            background-color: #000;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            padding: 15px;
            border-radius: 8px;
            height: 200px;
            overflow-y: auto;
            margin-top: 20px;
            border: 1px solid var(--border-color);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--primary-color);
            transition: width 0.3s ease;
            width: 0%;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .nav-tabs {
                overflow-x: auto;
            }
            
            .tab-content {
                padding: 20px;
            }
            
            .control-panel {
                flex-direction: column;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .pulse {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
    </style>
</head>
<body>
    <div class="theme-toggle" onclick="toggleTheme()" title="ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ">
        ğŸŒ“
    </div>

    <div class="container">
        <div class="header fade-in">
            <h1>ãƒ‡ãƒ¼ã‚¿æ§‹é€ ãƒ»ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å¯è¦–åŒ–ãƒ„ãƒ¼ãƒ«</h1>
            <p>ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®åŸºç¤æ¦‚å¿µã‚’è¦–è¦šçš„ã«å­¦ç¿’ã—ã‚ˆã†</p>
        </div>

        <div class="nav-tabs">
            <button class="tab-button active" onclick="showTab('data-structures')">ãƒ‡ãƒ¼ã‚¿æ§‹é€ </button>
            <button class="tab-button" onclick="showTab('sorting')">ã‚½ãƒ¼ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </button>
            <button class="tab-button" onclick="showTab('searching')">æ¢ç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </button>
            <button class="tab-button" onclick="showTab('graphs')">ã‚°ãƒ©ãƒ•ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </button>
        </div>

        <!-- ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚¿ãƒ– -->
        <div id="data-structures" class="tab-content active">
            <h2>ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®å¯è¦–åŒ–</h2>
            
            <div class="algorithm-selector">
                <div class="algorithm-card selected" onclick="selectDataStructure('array')">
                    <h3>é…åˆ— (Array)</h3>
                    <div class="complexity-badge">O(1) ã‚¢ã‚¯ã‚»ã‚¹</div>
                </div>
                <div class="algorithm-card" onclick="selectDataStructure('linkedlist')">
                    <h3>é€£çµãƒªã‚¹ãƒˆ</h3>
                    <div class="complexity-badge">O(n) æ¢ç´¢</div>
                </div>
                <div class="algorithm-card" onclick="selectDataStructure('stack')">
                    <h3>ã‚¹ã‚¿ãƒƒã‚¯</h3>
                    <div class="complexity-badge">O(1) Push/Pop</div>
                </div>
                <div class="algorithm-card" onclick="selectDataStructure('queue')">
                    <h3>ã‚­ãƒ¥ãƒ¼</h3>
                    <div class="complexity-badge">O(1) Enqueue/Dequeue</div>
                </div>
                <div class="algorithm-card" onclick="selectDataStructure('binarytree')">
                    <h3>äºŒåˆ†æœ¨</h3>
                    <div class="complexity-badge">O(log n) æ¢ç´¢</div>
                </div>
                <div class="algorithm-card" onclick="selectDataStructure('hashtable')">
                    <h3>ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«</h3>
                    <div class="complexity-badge">O(1) å¹³å‡</div>
                </div>
            </div>

            <div class="control-panel">
                <div class="control-group">
                    <label>ãƒ‡ãƒ¼ã‚¿å…¥åŠ›</label>
                    <input type="text" id="dataInput" class="control-input" placeholder="ä¾‹: 5,3,8,1,9" value="5,3,8,1,9,2,7,4,6">
                </div>
                <div class="control-group">
                    <label>æ“ä½œ</label>
                    <select id="operationSelect" class="control-input">
                        <option value="insert">æŒ¿å…¥</option>
                        <option value="delete">å‰Šé™¤</option>
                        <option value="search">æ¤œç´¢</option>
                        <option value="traverse">èµ°æŸ»</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>å€¤</label>
                    <input type="number" id="operationValue" class="control-input" placeholder="å€¤" value="10">
                </div>
                <button class="btn btn-primary" onclick="executeDataStructureOperation()">å®Ÿè¡Œ</button>
                <button class="btn btn-secondary" onclick="resetDataStructure()">ãƒªã‚»ãƒƒãƒˆ</button>
            </div>

            <div class="visualization-area">
                <canvas id="dataStructureCanvas" class="data-structure-canvas"></canvas>
            </div>

            <div class="stats-panel">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="dsOperations">0</div>
                        <div class="stat-label">æ“ä½œå›æ•°</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="dsElements">0</div>
                        <div class="stat-label">è¦ç´ æ•°</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="dsTimeComplexity">O(1)</div>
                        <div class="stat-label">æ™‚é–“è¨ˆç®—é‡</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="dsSpaceComplexity">O(n)</div>
                        <div class="stat-label">ç©ºé–“è¨ˆç®—é‡</div>
                    </div>
                </div>
            </div>

            <div class="explanation-panel">
                <h3 id="dsExplanationTitle">é…åˆ— (Array)</h3>
                <p id="dsExplanationText">é…åˆ—ã¯åŒã˜å‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’é€£ç¶šã—ãŸãƒ¡ãƒ¢ãƒªé ˜åŸŸã«æ ¼ç´ã™ã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã™ã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«ã‚ˆã‚‹é«˜é€Ÿãªã‚¢ã‚¯ã‚»ã‚¹ãŒç‰¹å¾´ã§ã™ã€‚</p>
                <div class="code-block" id="dsCodeBlock">
<pre>// é…åˆ—ã®åŸºæœ¬æ“ä½œ
let arr = [5, 3, 8, 1, 9];

// ã‚¢ã‚¯ã‚»ã‚¹: O(1)
console.log(arr[2]); // 8

// æŒ¿å…¥: O(n) - æœ«å°¾ã¯ O(1)
arr.push(10); // [5, 3, 8, 1, 9, 10]

// å‰Šé™¤: O(n) - æœ«å°¾ã¯ O(1)  
arr.pop(); // [5, 3, 8, 1, 9]</pre>
                </div>
            </div>
        </div>

        <!-- ã‚½ãƒ¼ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚¿ãƒ– -->
        <div id="sorting" class="tab-content">
            <h2>ã‚½ãƒ¼ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å¯è¦–åŒ–</h2>
            
            <div class="algorithm-selector">
                <div class="algorithm-card selected" onclick="selectSortAlgorithm('bubble')">
                    <h3>ãƒãƒ–ãƒ«ã‚½ãƒ¼ãƒˆ</h3>
                    <div class="complexity-badge">O(nÂ²)</div>
                </div>
                <div class="algorithm-card" onclick="selectSortAlgorithm('selection')">
                    <h3>é¸æŠã‚½ãƒ¼ãƒˆ</h3>
                    <div class="complexity-badge">O(nÂ²)</div>
                </div>
                <div class="algorithm-card" onclick="selectSortAlgorithm('insertion')">
                    <h3>æŒ¿å…¥ã‚½ãƒ¼ãƒˆ</h3>
                    <div class="complexity-badge">O(nÂ²)</div>
                </div>
                <div class="algorithm-card" onclick="selectSortAlgorithm('merge')">
                    <h3>ãƒãƒ¼ã‚¸ã‚½ãƒ¼ãƒˆ</h3>
                    <div class="complexity-badge">O(n log n)</div>
                </div>
                <div class="algorithm-card" onclick="selectSortAlgorithm('quick')">
                    <h3>ã‚¯ã‚¤ãƒƒã‚¯ã‚½ãƒ¼ãƒˆ</h3>
                    <div class="complexity-badge">O(n log n)</div>
                </div>
                <div class="algorithm-card" onclick="selectSortAlgorithm('heap')">
                    <h3>ãƒ’ãƒ¼ãƒ—ã‚½ãƒ¼ãƒˆ</h3>
                    <div class="complexity-badge">O(n log n)</div>
                </div>
            </div>

            <div class="control-panel">
                <div class="control-group">
                    <label>é…åˆ—ã‚µã‚¤ã‚º</label>
                    <input type="range" id="arraySizeSlider" class="control-input" min="5" max="50" value="15" onchange="generateRandomArray()">
                    <span id="arraySizeValue">15</span>
                </div>
                <div class="speed-control">
                    <label>å®Ÿè¡Œé€Ÿåº¦</label>
                    <input type="range" id="speedSlider" class="speed-slider" min="1" max="10" value="5">
                    <span>é«˜é€Ÿ â†â†’ ä½é€Ÿ</span>
                </div>
                <button class="btn btn-primary" onclick="startSorting()">ã‚½ãƒ¼ãƒˆé–‹å§‹</button>
                <button class="btn btn-secondary" onclick="pauseSorting()">ä¸€æ™‚åœæ­¢</button>
                <button class="btn btn-warning" onclick="stepSort()">ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œ</button>
                <button class="btn btn-secondary" onclick="generateRandomArray()">é…åˆ—ç”Ÿæˆ</button>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="sortProgress"></div>
            </div>

            <div class="visualization-area">
                <div id="sortVisualization"></div>
            </div>

            <div class="stats-panel">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="comparisons">0</div>
                        <div class="stat-label">æ¯”è¼ƒå›æ•°</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="swaps">0</div>
                        <div class="stat-label">äº¤æ›å›æ•°</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="arrayAccesses">0</div>
                        <div class="stat-label">é…åˆ—ã‚¢ã‚¯ã‚»ã‚¹</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="timeElapsed">0ms</div>
                        <div class="stat-label">å®Ÿè¡Œæ™‚é–“</div>
                    </div>
                </div>
            </div>

            <div class="explanation-panel">
                <h3 id="sortExplanationTitle">ãƒãƒ–ãƒ«ã‚½ãƒ¼ãƒˆ</h3>
                <p id="sortExplanationText">éš£æ¥ã™ã‚‹è¦ç´ ã‚’æ¯”è¼ƒã—ã€é †åºãŒé–“é•ã£ã¦ã„ã‚Œã°äº¤æ›ã‚’ç¹°ã‚Šè¿”ã™ã‚½ãƒ¼ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚</p>
                <div class="code-block" id="sortCodeBlock">
<pre>function bubbleSort(arr) {
    let n = arr.length;
    for (let i = 0; i < n - 1; i++) {
        for (let j = 0; j < n - i - 1; j++) {
            if (arr[j] > arr[j + 1]) {
                // äº¤æ›
                [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
            }
        }
    }
    return arr;
}</pre>
                </div>
            </div>
        </div>

        <!-- æ¢ç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚¿ãƒ– -->
        <div id="searching" class="tab-content">
            <h2>æ¢ç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å¯è¦–åŒ–</h2>
            
            <div class="algorithm-selector">
                <div class="algorithm-card selected" onclick="selectSearchAlgorithm('linear')">
                    <h3>ç·šå½¢æ¢ç´¢</h3>
                    <div class="complexity-badge">O(n)</div>
                </div>
                <div class="algorithm-card" onclick="selectSearchAlgorithm('binary')">
                    <h3>äºŒåˆ†æ¢ç´¢</h3>
                    <div class="complexity-badge">O(log n)</div>
                </div>
                <div class="algorithm-card" onclick="selectSearchAlgorithm('jump')">
                    <h3>ã‚¸ãƒ£ãƒ³ãƒ—æ¢ç´¢</h3>
                    <div class="complexity-badge">O(âˆšn)</div>
                </div>
                <div class="algorithm-card" onclick="selectSearchAlgorithm('interpolation')">
                    <h3>è£œé–“æ¢ç´¢</h3>
                    <div class="complexity-badge">O(log log n)</div>
                </div>
            </div>

            <div class="control-panel">
                <div class="control-group">
                    <label>é…åˆ—ãƒ‡ãƒ¼ã‚¿</label>
                    <input type="text" id="searchArrayInput" class="control-input" placeholder="ã‚½ãƒ¼ãƒˆæ¸ˆã¿é…åˆ—" value="1,3,5,7,9,11,13,15,17,19,21,23,25,27,29">
                </div>
                <div class="control-group">
                    <label>æ¤œç´¢å€¤</label>
                    <input type="number" id="searchValue" class="control-input" placeholder="æ¤œç´¢ã—ãŸã„å€¤" value="15">
                </div>
                <button class="btn btn-primary" onclick="startSearch()">æ¢ç´¢é–‹å§‹</button>
                <button class="btn btn-secondary" onclick="resetSearch()">ãƒªã‚»ãƒƒãƒˆ</button>
                <button class="btn btn-warning" onclick="generateSortedArray()">ã‚½ãƒ¼ãƒˆæ¸ˆã¿é…åˆ—ç”Ÿæˆ</button>
            </div>

            <div class="visualization-area">
                <div id="searchVisualization"></div>
            </div>

            <div class="stats-panel">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="searchComparisons">0</div>
                        <div class="stat-label">æ¯”è¼ƒå›æ•°</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="searchSteps">0</div>
                        <div class="stat-label">ã‚¹ãƒ†ãƒƒãƒ—æ•°</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="searchResult">æœªå®Ÿè¡Œ</div>
                        <div class="stat-label">çµæœ</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="searchTime">0ms</div>
                        <div class="stat-label">å®Ÿè¡Œæ™‚é–“</div>
                    </div>
                </div>
            </div>

            <div class="explanation-panel">
                <h3 id="searchExplanationTitle">ç·šå½¢æ¢ç´¢</h3>
                <p id="searchExplanationText">é…åˆ—ã®æœ€åˆã‹ã‚‰é †ç•ªã«è¦ç´ ã‚’ç¢ºèªã—ã¦ã„ãæœ€ã‚‚åŸºæœ¬çš„ãªæ¢ç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚</p>
                <div class="code-block" id="searchCodeBlock">
<pre>function linearSearch(arr, target) {
    for (let i = 0; i < arr.length; i++) {
        if (arr[i] === target) {
            return i; // è¦‹ã¤ã‹ã£ãŸä½ç½®ã‚’è¿”ã™
        }
    }
    return -1; // è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ
}</pre>
                </div>
            </div>
        </div>

        <!-- ã‚°ãƒ©ãƒ•ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚¿ãƒ– -->
        <div id="graphs" class="tab-content">
            <h2>ã‚°ãƒ©ãƒ•ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å¯è¦–åŒ–</h2>
            
            <div class="algorithm-selector">
                <div class="algorithm-card selected" onclick="selectGraphAlgorithm('dfs')">
                    <h3>æ·±ã•å„ªå…ˆæ¢ç´¢</h3>
                    <div class="complexity-badge">O(V + E)</div>
                </div>
                <div class="algorithm-card" onclick="selectGraphAlgorithm('bfs')">
                    <h3>å¹…å„ªå…ˆæ¢ç´¢</h3>
                    <div class="complexity-badge">O(V + E)</div>
                </div>
                <div class="algorithm-card" onclick="selectGraphAlgorithm('dijkstra')">
                    <h3>ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•</h3>
                    <div class="complexity-badge">O(VÂ²)</div>
                </div>
                <div class="algorithm-card" onclick="selectGraphAlgorithm('astar')">
                    <h3>A*ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </h3>
                    <div class="complexity-badge">O(b^d)</div>
                </div>
            </div>

            <div class="control-panel">
                <div class="control-group">
                    <label>ã‚°ãƒ©ãƒ•ã‚¿ã‚¤ãƒ—</label>
                    <select id="graphType" class="control-input">
                        <option value="grid">ã‚°ãƒªãƒƒãƒ‰</option>
                        <option value="tree">ãƒ„ãƒªãƒ¼</option>
                        <option value="random">ãƒ©ãƒ³ãƒ€ãƒ </option>
                    </select>
                </div>
                <div class="control-group">
                    <label>é–‹å§‹ãƒãƒ¼ãƒ‰</label>
                    <input type="number" id="startNode" class="control-input" value="0" min="0" max="24">
                </div>
                <div class="control-group">
                    <label>çµ‚äº†ãƒãƒ¼ãƒ‰</label>
                    <input type="number" id="endNode" class="control-input" value="24" min="0" max="24">
                </div>
                <button class="btn btn-primary" onclick="startGraphTraversal()">æ¢ç´¢é–‹å§‹</button>
                <button class="btn btn-secondary" onclick="resetGraph()">ãƒªã‚»ãƒƒãƒˆ</button>
                <button class="btn btn-warning" onclick="generateGraph()">ã‚°ãƒ©ãƒ•ç”Ÿæˆ</button>
            </div>

            <div class="visualization-area">
                <canvas id="graphCanvas" class="data-structure-canvas"></canvas>
            </div>

            <div class="stats-panel">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="visitedNodes">0</div>
                        <div class="stat-label">è¨ªå•ãƒãƒ¼ãƒ‰æ•°</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="pathLength">0</div>
                        <div class="stat-label">ãƒ‘ã‚¹é•·</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="graphTime">0ms</div>
                        <div class="stat-label">å®Ÿè¡Œæ™‚é–“</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="efficiency">0%</div>
                        <div class="stat-label">åŠ¹ç‡æ€§</div>
                    </div>
                </div>
            </div>

            <div class="explanation-panel">
                <h3 id="graphExplanationTitle">æ·±ã•å„ªå…ˆæ¢ç´¢ (DFS)</h3>
                <p id="graphExplanationText">å¯èƒ½ãªé™ã‚Šæ·±ãæ¢ç´¢ã—ã¦ã‹ã‚‰ã€æ¬¡ã®åˆ†å²ã‚’æ¢ç´¢ã™ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚ã‚¹ã‚¿ãƒƒã‚¯ã¾ãŸã¯å†å¸°ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</p>
                <div class="code-block" id="graphCodeBlock">
<pre>function dfs(graph, start, visited = new Set()) {
    visited.add(start);
    console.log(start);
    
    for (let neighbor of graph[start]) {
        if (!visited.has(neighbor)) {
            dfs(graph, neighbor, visited);
        }
    }
}</pre>
                </div>
            </div>
        </div>

        <div class="log-output" id="logOutput">
ã‚·ã‚¹ãƒ†ãƒ æº–å‚™å®Œäº†
ãƒ‡ãƒ¼ã‚¿æ§‹é€ ãƒ»ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å¯è¦–åŒ–ãƒ„ãƒ¼ãƒ« v1.0.0 èµ·å‹•
ãƒ­ã‚°è¨˜éŒ²é–‹å§‹: <span id="currentTime"></span>
        </div>
    </div>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let currentTab = 'data-structures';
        let currentDataStructure = 'array';
        let currentSortAlgorithm = 'bubble';
        let currentSearchAlgorithm = 'linear';
        let currentGraphAlgorithm = 'dfs';
        let isAnimating = false;
        let animationSpeed = 500;
        
        // çµ±è¨ˆãƒ‡ãƒ¼ã‚¿
        let stats = {
            operations: 0,
            comparisons: 0,
            swaps: 0,
            arrayAccesses: 0,
            elements: 0,
            visitedNodes: 0
        };

        // ãƒ‡ãƒ¼ã‚¿ä¿å­˜ç”¨
        let dataStructureData = [5, 3, 8, 1, 9, 2, 7, 4, 6];
        let sortingArray = [];
        let searchArray = [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29];
        let graph = [];
        let graphNodes = [];

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateCurrentTime();
            initializeDataStructure();
            generateRandomArray();
            generateGraph();
            logMessage('ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–å®Œäº†');
            
            // å®šæœŸçš„ã«æ™‚åˆ»æ›´æ–°
            setInterval(updateCurrentTime, 1000);
        });

        function updateCurrentTime() {
            const now = new Date();
            document.getElementById('currentTime').textContent = now.toLocaleString('ja-JP');
        }

        function logMessage(message) {
            const logOutput = document.getElementById('logOutput');
            const timestamp = new Date().toLocaleTimeString('ja-JP');
            logOutput.innerHTML += `\n[${timestamp}] ${message}`;
            logOutput.scrollTop = logOutput.scrollHeight;
        }

        // ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ
        function toggleTheme() {
            const body = document.body;
            const currentTheme = body.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            body.setAttribute('data-theme', newTheme);
            logMessage(`ãƒ†ãƒ¼ãƒã‚’${newTheme}ãƒ¢ãƒ¼ãƒ‰ã«å¤‰æ›´`);
        }

        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
        function showTab(tabName) {
            // å…¨ã¦ã®ã‚¿ãƒ–ã‚’éè¡¨ç¤º
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // å…¨ã¦ã®ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã‚’éã‚¢ã‚¯ãƒ†ã‚£ãƒ–
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // é¸æŠã•ã‚ŒãŸã‚¿ãƒ–ã‚’è¡¨ç¤º
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            currentTab = tabName;
            logMessage(`${tabName}ã‚¿ãƒ–ã«åˆ‡ã‚Šæ›¿ãˆ`);
        }

        // ãƒ‡ãƒ¼ã‚¿æ§‹é€ é¸æŠ
        function selectDataStructure(dsType) {
            document.querySelectorAll('#data-structures .algorithm-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.algorithm-card').classList.add('selected');
            
            currentDataStructure = dsType;
            updateDataStructureExplanation(dsType);
            initializeDataStructure();
            logMessage(`ãƒ‡ãƒ¼ã‚¿æ§‹é€ : ${dsType}ã‚’é¸æŠ`);
        }

        // ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®èª¬æ˜æ›´æ–°
        function updateDataStructureExplanation(dsType) {
            const explanations = {
                array: {
                    title: 'é…åˆ— (Array)',
                    text: 'é…åˆ—ã¯åŒã˜å‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’é€£ç¶šã—ãŸãƒ¡ãƒ¢ãƒªé ˜åŸŸã«æ ¼ç´ã™ã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã™ã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«ã‚ˆã‚‹é«˜é€Ÿãªã‚¢ã‚¯ã‚»ã‚¹ãŒç‰¹å¾´ã§ã™ã€‚',
                    code: `// é…åˆ—ã®åŸºæœ¬æ“ä½œ
let arr = [5, 3, 8, 1, 9];

// ã‚¢ã‚¯ã‚»ã‚¹: O(1)
console.log(arr[2]); // 8

// æŒ¿å…¥: O(n) - æœ«å°¾ã¯ O(1)
arr.push(10);

// å‰Šé™¤: O(n) - æœ«å°¾ã¯ O(1)  
arr.pop();`
                },
                linkedlist: {
                    title: 'é€£çµãƒªã‚¹ãƒˆ (Linked List)',
                    text: 'å„ãƒãƒ¼ãƒ‰ãŒãƒ‡ãƒ¼ã‚¿ã¨æ¬¡ã®ãƒãƒ¼ãƒ‰ã¸ã®å‚ç…§ã‚’æŒã¤ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã™ã€‚å‹•çš„ãªã‚µã‚¤ã‚ºå¤‰æ›´ãŒå¯èƒ½ã§ã™ã€‚',
                    code: `// é€£çµãƒªã‚¹ãƒˆã®ãƒãƒ¼ãƒ‰
class Node {
    constructor(data) {
        this.data = data;
        this.next = null;
    }
}

// æŒ¿å…¥: O(1) - å…ˆé ­ã«æŒ¿å…¥
// æ¢ç´¢: O(n)
// å‰Šé™¤: O(n)`
                },
                stack: {
                    title: 'ã‚¹ã‚¿ãƒƒã‚¯ (Stack)',
                    text: 'LIFOï¼ˆLast In, First Outï¼‰ã®åŸå‰‡ã«å¾“ã†ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã™ã€‚æœ€å¾Œã«è¿½åŠ ã•ã‚ŒãŸè¦ç´ ãŒæœ€åˆã«å‰Šé™¤ã•ã‚Œã¾ã™ã€‚',
                    code: `class Stack {
    constructor() {
        this.items = [];
    }
    
    push(item) { // O(1)
        this.items.push(item);
    }
    
    pop() { // O(1)
        return this.items.pop();
    }
}`
                },
                queue: {
                    title: 'ã‚­ãƒ¥ãƒ¼ (Queue)',
                    text: 'FIFOï¼ˆFirst In, First Outï¼‰ã®åŸå‰‡ã«å¾“ã†ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã™ã€‚æœ€åˆã«è¿½åŠ ã•ã‚ŒãŸè¦ç´ ãŒæœ€åˆã«å‰Šé™¤ã•ã‚Œã¾ã™ã€‚',
                    code: `class Queue {
    constructor() {
        this.items = [];
    }
    
    enqueue(item) { // O(1)
        this.items.push(item);
    }
    
    dequeue() { // O(1)
        return this.items.shift();
    }
}`
                },
                binarytree: {
                    title: 'äºŒåˆ†æœ¨ (Binary Tree)',
                    text: 'å„ãƒãƒ¼ãƒ‰ãŒæœ€å¤§2ã¤ã®å­ãƒãƒ¼ãƒ‰ã‚’æŒã¤æœ¨æ§‹é€ ã§ã™ã€‚äºŒåˆ†æ¢ç´¢æœ¨ã§ã¯åŠ¹ç‡çš„ãªæ¢ç´¢ãŒå¯èƒ½ã§ã™ã€‚',
                    code: `class TreeNode {
    constructor(val) {
        this.val = val;
        this.left = null;
        this.right = null;
    }
}

// æ¢ç´¢: O(log n) - å¹³å‡
// æŒ¿å…¥: O(log n) - å¹³å‡
// å‰Šé™¤: O(log n) - å¹³å‡`
                },
                hashtable: {
                    title: 'ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ« (Hash Table)',
                    text: 'ãƒãƒƒã‚·ãƒ¥é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ã‚­ãƒ¼ã‚’é…åˆ—ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«ãƒãƒƒãƒ—ã™ã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã™ã€‚é«˜é€Ÿãªæ¤œç´¢ãŒå¯èƒ½ã§ã™ã€‚',
                    code: `class HashTable {
    constructor(size = 10) {
        this.size = size;
        this.table = new Array(size);
    }
    
    hash(key) {
        return key % this.size;
    }
    
    set(key, value) { // O(1) å¹³å‡
        const index = this.hash(key);
        this.table[index] = value;
    }
}`
                }
            };

            const explanation = explanations[dsType];
            document.getElementById('dsExplanationTitle').textContent = explanation.title;
            document.getElementById('dsExplanationText').textContent = explanation.text;
            document.getElementById('dsCodeBlock').innerHTML = `<pre>${explanation.code}</pre>`;
        }

        // ãƒ‡ãƒ¼ã‚¿æ§‹é€ åˆæœŸåŒ–
        function initializeDataStructure() {
            stats.elements = dataStructureData.length;
            updateDataStructureStats();
            drawDataStructure();
        }

        // ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®æç”»
        function drawDataStructure() {
            const canvas = document.getElementById('dataStructureCanvas');
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            switch(currentDataStructure) {
                case 'array':
                    drawArray(ctx);
                    break;
                case 'linkedlist':
                    drawLinkedList(ctx);
                    break;
                case 'stack':
                    drawStack(ctx);
                    break;
                case 'queue':
                    drawQueue(ctx);
                    break;
                case 'binarytree':
                    drawBinaryTree(ctx);
                    break;
                case 'hashtable':
                    drawHashTable(ctx);
                    break;
            }
        }

        function drawArray(ctx) {
            const elementWidth = 60;
            const elementHeight = 60;
            const startX = 50;
            const startY = canvas.height / 2 - elementHeight / 2;
            
            dataStructureData.forEach((value, index) => {
                const x = startX + index * (elementWidth + 10);
                const y = startY;
                
                // è¦ç´ ã®æç”»
                ctx.fillStyle = '#3b82f6';
                ctx.fillRect(x, y, elementWidth, elementHeight);
                
                // æ ç·š
                ctx.strokeStyle = '#1d4ed8';
                ctx.lineWidth = 2;
                ctx.strokeRect(x, y, elementWidth, elementHeight);
                
                // å€¤ã®æç”»
                ctx.fillStyle = 'white';
                ctx.font = 'bold 16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(value, x + elementWidth/2, y + elementHeight/2 + 6);
                
                // ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æç”»
                ctx.fillStyle = '#6b7280';
                ctx.font = '12px Arial';
                ctx.fillText(index, x + elementWidth/2, y - 10);
            });
        }

        function drawLinkedList(ctx) {
            const nodeSize = 50;
            const nodeSpacing = 100;
            const startX = 50;
            const startY = canvas.height / 2;
            
            dataStructureData.forEach((value, index) => {
                const x = startX + index * nodeSpacing;
                const y = startY;
                
                // ãƒãƒ¼ãƒ‰ã®æç”»
                ctx.fillStyle = '#3b82f6';
                ctx.beginPath();
                ctx.arc(x, y, nodeSize/2, 0, 2 * Math.PI);
                ctx.fill();
                
                // å€¤ã®æç”»
                ctx.fillStyle = 'white';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(value, x, y + 5);
                
                // çŸ¢å°ã®æç”»
                if (index < dataStructureData.length - 1) {
                    ctx.strokeStyle = '#1d4ed8';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.moveTo(x + nodeSize/2, y);
                    ctx.lineTo(x + nodeSpacing - nodeSize/2, y);
                    ctx.stroke();
                    
                    // çŸ¢å°ã®é ­éƒ¨
                    ctx.beginPath();
                    ctx.moveTo(x + nodeSpacing - nodeSize/2 - 10, y - 5);
                    ctx.lineTo(x + nodeSpacing - nodeSize/2, y);
                    ctx.lineTo(x + nodeSpacing - nodeSize/2 - 10, y + 5);
                    ctx.stroke();
                }
            });
        }

        function drawStack(ctx) {
            const elementWidth = 80;
            const elementHeight = 40;
            const startX = canvas.width / 2 - elementWidth / 2;
            const startY = canvas.height - 50;
            
            dataStructureData.forEach((value, index) => {
                const x = startX;
                const y = startY - index * (elementHeight + 5);
                
                // è¦ç´ ã®æç”»
                ctx.fillStyle = index === dataStructureData.length - 1 ? '#f59e0b' : '#3b82f6';
                ctx.fillRect(x, y, elementWidth, elementHeight);
                
                // æ ç·š
                ctx.strokeStyle = '#1d4ed8';
                ctx.lineWidth = 2;
                ctx.strokeRect(x, y, elementWidth, elementHeight);
                
                // å€¤ã®æç”»
                ctx.fillStyle = 'white';
                ctx.font = 'bold 16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(value, x + elementWidth/2, y + elementHeight/2 + 6);
            });
            
            // TOPãƒ©ãƒ™ãƒ«
            if (dataStructureData.length > 0) {
                ctx.fillStyle = '#f59e0b';
                ctx.font = 'bold 14px Arial';
                ctx.fillText('TOP', startX + elementWidth + 20, startY - (dataStructureData.length - 1) * (elementHeight + 5) + elementHeight/2);
            }
        }

        function drawQueue(ctx) {
            const elementWidth = 60;
            const elementHeight = 60;
            const startX = 50;
            const startY = canvas.height / 2 - elementHeight / 2;
            
            dataStructureData.forEach((value, index) => {
                const x = startX + index * (elementWidth + 10);
                const y = startY;
                
                // è¦ç´ ã®æç”»
                let fillColor = '#3b82f6';
                if (index === 0) fillColor = '#10b981'; // FRONT
                if (index === dataStructureData.length - 1) fillColor = '#f59e0b'; // REAR
                
                ctx.fillStyle = fillColor;
                ctx.fillRect(x, y, elementWidth, elementHeight);
                
                // æ ç·š
                ctx.strokeStyle = '#1d4ed8';
                ctx.lineWidth = 2;
                ctx.strokeRect(x, y, elementWidth, elementHeight);
                
                // å€¤ã®æç”»
                ctx.fillStyle = 'white';
                ctx.font = 'bold 16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(value, x + elementWidth/2, y + elementHeight/2 + 6);
            });
            
            // FRONTã¨REARãƒ©ãƒ™ãƒ«
            if (dataStructureData.length > 0) {
                ctx.fillStyle = '#10b981';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('FRONT', startX + elementWidth/2, startY - 15);
                
                ctx.fillStyle = '#f59e0b';
                ctx.fillText('REAR', startX + (dataStructureData.length - 1) * (elementWidth + 10) + elementWidth/2, startY - 15);
            }
        }

        function drawBinaryTree(ctx) {
            if (dataStructureData.length === 0) return;
            
            const nodeSize = 40;
            const levelHeight = 80;
            const rootX = canvas.width / 2;
            const rootY = 80;
            
            function drawNode(value, x, y, level) {
                // ãƒãƒ¼ãƒ‰ã®æç”»
                ctx.fillStyle = '#3b82f6';
                ctx.beginPath();
                ctx.arc(x, y, nodeSize/2, 0, 2 * Math.PI);
                ctx.fill();
                
                ctx.strokeStyle = '#1d4ed8';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // å€¤ã®æç”»
                ctx.fillStyle = 'white';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(value, x, y + 5);
            }
            
            // ç°¡å˜ãªäºŒåˆ†æœ¨ã®æç”»ï¼ˆå®Œå…¨äºŒåˆ†æœ¨ã¨ã—ã¦ï¼‰
            dataStructureData.forEach((value, index) => {
                const level = Math.floor(Math.log2(index + 1));
                const positionInLevel = index - (Math.pow(2, level) - 1);
                const nodesInLevel = Math.pow(2, level);
                const spacing = canvas.width / (nodesInLevel + 1);
                
                const x = spacing * (positionInLevel + 1);
                const y = rootY + level * levelHeight;
                
                drawNode(value, x, y, level);
                
                // è¦ªãƒãƒ¼ãƒ‰ã¸ã®ç·šã‚’æç”»
                if (index > 0) {
                    const parentIndex = Math.floor((index - 1) / 2);
                    const parentLevel = Math.floor(Math.log2(parentIndex + 1));
                    const parentPositionInLevel = parentIndex - (Math.pow(2, parentLevel) - 1);
                    const parentNodesInLevel = Math.pow(2, parentLevel);
                    const parentSpacing = canvas.width / (parentNodesInLevel + 1);
                    
                    const parentX = parentSpacing * (parentPositionInLevel + 1);
                    const parentY = rootY + parentLevel * levelHeight;
                    
                    ctx.strokeStyle = '#6b7280';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.moveTo(parentX, parentY + nodeSize/2);
                    ctx.lineTo(x, y - nodeSize/2);
                    ctx.stroke();
                }
            });
        }

        function drawHashTable(ctx) {
            const bucketWidth = 80;
            const bucketHeight = 50;
            const bucketsPerRow = 5;
            const startX = 50;
            const startY = 50;
            
            // ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒã‚±ãƒƒãƒˆæ•°ã‚’10ã¨ã™ã‚‹
            for (let i = 0; i < 10; i++) {
                const row = Math.floor(i / bucketsPerRow);
                const col = i % bucketsPerRow;
                const x = startX + col * (bucketWidth + 10);
                const y = startY + row * (bucketHeight + 30);
                
                // ãƒã‚±ãƒƒãƒˆã®æç”»
                ctx.fillStyle = '#f3f4f6';
                ctx.fillRect(x, y, bucketWidth, bucketHeight);
                
                ctx.strokeStyle = '#6b7280';
                ctx.lineWidth = 1;
                ctx.strokeRect(x, y, bucketWidth, bucketHeight);
                
                // ãƒã‚±ãƒƒãƒˆç•ªå·
                ctx.fillStyle = '#374151';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(i, x + bucketWidth/2, y - 5);
                
                // ãƒã‚±ãƒƒãƒˆå†…ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆç°¡å˜ãªãƒãƒƒã‚·ãƒ¥é–¢æ•°ã‚’ä½¿ç”¨ï¼‰
                const hashedValues = dataStructureData.filter(val => val % 10 === i);
                if (hashedValues.length > 0) {
                    ctx.fillStyle = '#3b82f6';
                    ctx.fillRect(x + 5, y + 5, bucketWidth - 10, bucketHeight - 10);
                    
                    ctx.fillStyle = 'white';
                    ctx.font = 'bold 14px Arial';
                    ctx.fillText(hashedValues[0], x + bucketWidth/2, y + bucketHeight/2 + 5);
                    
                    if (hashedValues.length > 1) {
                        ctx.fillStyle = '#ef4444';
                        ctx.font = '10px Arial';
                        ctx.fillText(`+${hashedValues.length - 1}`, x + bucketWidth - 15, y + 15);
                    }
                }
            }
        }

        // ãƒ‡ãƒ¼ã‚¿æ§‹é€ æ“ä½œå®Ÿè¡Œ
        function executeDataStructureOperation() {
            const operation = document.getElementById('operationSelect').value;
            const value = parseInt(document.getElementById('operationValue').value);
            
            stats.operations++;
            
            switch(operation) {
                case 'insert':
                    dataStructureData.push(value);
                    logMessage(`å€¤ ${value} ã‚’æŒ¿å…¥`);
                    break;
                case 'delete':
                    const index = dataStructureData.indexOf(value);
                    if (index !== -1) {
                        dataStructureData.splice(index, 1);
                        logMessage(`å€¤ ${value} ã‚’å‰Šé™¤`);
                    } else {
                        logMessage(`å€¤ ${value} ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);
                    }
                    break;
                case 'search':
                    const found = dataStructureData.indexOf(value);
                    if (found !== -1) {
                        logMessage(`å€¤ ${value} ãŒã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ ${found} ã§è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ`);
                    } else {
                        logMessage(`å€¤ ${value} ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);
                    }
                    break;
                case 'traverse':
                    logMessage(`å…¨è¦ç´ : [${dataStructureData.join(', ')}]`);
                    break;
            }
            
            stats.elements = dataStructureData.length;
            updateDataStructureStats();
            drawDataStructure();
        }

        // ãƒ‡ãƒ¼ã‚¿æ§‹é€ ãƒªã‚»ãƒƒãƒˆ
        function resetDataStructure() {
            const input = document.getElementById('dataInput').value;
            dataStructureData = input.split(',').map(x => parseInt(x.trim())).filter(x => !isNaN(x));
            stats.operations = 0;
            stats.elements = dataStructureData.length;
            updateDataStructureStats();
            drawDataStructure();
            logMessage('ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’ãƒªã‚»ãƒƒãƒˆ');
        }

        // ãƒ‡ãƒ¼ã‚¿æ§‹é€ çµ±è¨ˆæ›´æ–°
        function updateDataStructureStats() {
            document.getElementById('dsOperations').textContent = stats.operations;
            document.getElementById('dsElements').textContent = stats.elements;
            
            // æ™‚é–“è¨ˆç®—é‡ã®è¨­å®š
            const complexities = {
                array: 'O(1)',
                linkedlist: 'O(n)',
                stack: 'O(1)',
                queue: 'O(1)',
                binarytree: 'O(log n)',
                hashtable: 'O(1)'
            };
            document.getElementById('dsTimeComplexity').textContent = complexities[currentDataStructure];
            document.getElementById('dsSpaceComplexity').textContent = 'O(n)';
        }

        // ã‚½ãƒ¼ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ é¸æŠ
        function selectSortAlgorithm(algorithm) {
            document.querySelectorAll('#sorting .algorithm-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.algorithm-card').classList.add('selected');
            
            currentSortAlgorithm = algorithm;
            updateSortExplanation(algorithm);
            logMessage(`ã‚½ãƒ¼ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ : ${algorithm}ã‚’é¸æŠ`);
        }

        // ã‚½ãƒ¼ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®èª¬æ˜æ›´æ–°
        function updateSortExplanation(algorithm) {
            const explanations = {
                bubble: {
                    title: 'ãƒãƒ–ãƒ«ã‚½ãƒ¼ãƒˆ',
                    text: 'éš£æ¥ã™ã‚‹è¦ç´ ã‚’æ¯”è¼ƒã—ã€é †åºãŒé–“é•ã£ã¦ã„ã‚Œã°äº¤æ›ã‚’ç¹°ã‚Šè¿”ã™ã‚½ãƒ¼ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚',
                    code: `function bubbleSort(arr) {
    let n = arr.length;
    for (let i = 0; i < n - 1; i++) {
        for (let j = 0; j < n - i - 1; j++) {
            if (arr[j] > arr[j + 1]) {
                [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
            }
        }
    }
}`
                },
                selection: {
                    title: 'é¸æŠã‚½ãƒ¼ãƒˆ',
                    text: 'æœªã‚½ãƒ¼ãƒˆéƒ¨åˆ†ã‹ã‚‰æœ€å°å€¤ã‚’é¸æŠã—ã€å…ˆé ­ã«é…ç½®ã™ã‚‹ã“ã¨ã‚’ç¹°ã‚Šè¿”ã™ã‚½ãƒ¼ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚',
                    code: `function selectionSort(arr) {
    let n = arr.length;
    for (let i = 0; i < n - 1; i++) {
        let minIdx = i;
        for (let j = i + 1; j < n; j++) {
            if (arr[j] < arr[minIdx]) {
                minIdx = j;
            }
        }
        [arr[i], arr[minIdx]] = [arr[minIdx], arr[i]];
    }
}`
                },
                insertion: {
                    title: 'æŒ¿å…¥ã‚½ãƒ¼ãƒˆ',
                    text: 'è¦ç´ ã‚’ä¸€ã¤ãšã¤å–ã‚Šå‡ºã—ã€æ—¢ã«ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸéƒ¨åˆ†ã®é©åˆ‡ãªä½ç½®ã«æŒ¿å…¥ã™ã‚‹ã‚½ãƒ¼ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚',
                    code: `function insertionSort(arr) {
    for (let i = 1; i < arr.length; i++) {
        let key = arr[i];
        let j = i - 1;
        while (j >= 0 && arr[j] > key) {
            arr[j + 1] = arr[j];
            j--;
        }
        arr[j + 1] = key;
    }
}`
                },
                merge: {
                    title: 'ãƒãƒ¼ã‚¸ã‚½ãƒ¼ãƒˆ',
                    text: 'åˆ†å‰²çµ±æ²»æ³•ã‚’ä½¿ç”¨ã—ã€é…åˆ—ã‚’åˆ†å‰²ã—ã¦ã‹ã‚‰çµ±åˆã—ãªãŒã‚‰ã‚½ãƒ¼ãƒˆã™ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚',
                    code: `function mergeSort(arr) {
    if (arr.length <= 1) return arr;
    
    const mid = Math.floor(arr.length / 2);
    const left = mergeSort(arr.slice(0, mid));
    const right = mergeSort(arr.slice(mid));
    
    return merge(left, right);
}

function merge(left, right) {
    let result = [];
    let i = 0, j = 0;
    
    while (i < left.length && j < right.length) {
        if (left[i] <= right[j]) {
            result.push(left[i]);
            i++;
        } else {
            result.push(right[j]);
            j++;
        }
    }
    
    return result.concat(left.slice(i)).concat(right.slice(j));
}`
                },
                quick: {
                    title: 'ã‚¯ã‚¤ãƒƒã‚¯ã‚½ãƒ¼ãƒˆ',
                    text: 'ãƒ”ãƒœãƒƒãƒˆè¦ç´ ã‚’é¸æŠã—ã€ãã‚Œã‚ˆã‚Šå°ã•ã„è¦ç´ ã¨å¤§ãã„è¦ç´ ã«åˆ†å‰²ã—ã¦ã‚½ãƒ¼ãƒˆã™ã‚‹åˆ†å‰²çµ±æ²»æ³•ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚',
                    code: `function quickSort(arr, low = 0, high = arr.length - 1) {
    if (low < high) {
        let pi = partition(arr, low, high);
        quickSort(arr, low, pi - 1);
        quickSort(arr, pi + 1, high);
    }
}

function partition(arr, low, high) {
    let pivot = arr[high];
    let i = low - 1;
    
    for (let j = low; j < high; j++) {
        if (arr[j] < pivot) {
            i++;
            [arr[i], arr[j]] = [arr[j], arr[i]];
        }
    }
    [arr[i + 1], arr[high]] = [arr[high], arr[i + 1]];
    return i + 1;
}`
                },
                heap: {
                    title: 'ãƒ’ãƒ¼ãƒ—ã‚½ãƒ¼ãƒˆ',
                    text: 'ãƒ’ãƒ¼ãƒ—ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’ä½¿ç”¨ã—ã¦ã‚½ãƒ¼ãƒˆã™ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚æœ€å¤§ãƒ’ãƒ¼ãƒ—ã‚’æ§‹ç¯‰ã—ã¦ã‹ã‚‰è¦ç´ ã‚’å–ã‚Šå‡ºã—ã¾ã™ã€‚',
                    code: `function heapSort(arr) {
    buildMaxHeap(arr);
    
    for (let i = arr.length - 1; i > 0; i--) {
        [arr[0], arr[i]] = [arr[i], arr[0]];
        heapify(arr, 0, i);
    }
}

function buildMaxHeap(arr) {
    let n = arr.length;
    for (let i = Math.floor(n / 2) - 1; i >= 0; i--) {
        heapify(arr, i, n);
    }
}`
                }
            };

            const explanation = explanations[algorithm];
            document.getElementById('sortExplanationTitle').textContent = explanation.title;
            document.getElementById('sortExplanationText').textContent = explanation.text;
            document.getElementById('sortCodeBlock').innerHTML = `<pre>${explanation.code}</pre>`;
        }

        // ãƒ©ãƒ³ãƒ€ãƒ é…åˆ—ç”Ÿæˆ
        function generateRandomArray() {
            const size = parseInt(document.getElementById('arraySizeSlider').value);
            document.getElementById('arraySizeValue').textContent = size;
            
            sortingArray = Array.from({length: size}, () => Math.floor(Math.random() * 100) + 1);
            displaySortArray();
            resetSortStats();
            logMessage(`ã‚µã‚¤ã‚º${size}ã®ãƒ©ãƒ³ãƒ€ãƒ é…åˆ—ã‚’ç”Ÿæˆ`);
        }

        // ã‚½ãƒ¼ãƒˆé…åˆ—ã®è¡¨ç¤º
        function displaySortArray() {
            const visualization = document.getElementById('sortVisualization');
            visualization.innerHTML = '';
            
            sortingArray.forEach((value, index) => {
                const element = document.createElement('div');
                element.className = 'array-element';
                element.textContent = value;
                element.id = `sort-element-${index}`;
                
                const indexLabel = document.createElement('div');
                indexLabel.className = 'array-index';
                indexLabel.textContent = index;
                element.appendChild(indexLabel);
                
                visualization.appendChild(element);
            });
        }

        // ã‚½ãƒ¼ãƒˆçµ±è¨ˆãƒªã‚»ãƒƒãƒˆ
        function resetSortStats() {
            stats.comparisons = 0;
            stats.swaps = 0;
            stats.arrayAccesses = 0;
            updateSortStats();
            document.getElementById('sortProgress').style.width = '0%';
        }

        // ã‚½ãƒ¼ãƒˆçµ±è¨ˆæ›´æ–°
        function updateSortStats() {
            document.getElementById('comparisons').textContent = stats.comparisons;
            document.getElementById('swaps').textContent = stats.swaps;
            document.getElementById('arrayAccesses').textContent = stats.arrayAccesses;
        }

        // ã‚½ãƒ¼ãƒˆé–‹å§‹
        async function startSorting() {
            if (isAnimating) return;
            
            isAnimating = true;
            const startTime = Date.now();
            resetSortStats();
            
            animationSpeed = 1100 - parseInt(document.getElementById('speedSlider').value) * 100;
            
            logMessage(`${currentSortAlgorithm}ã‚½ãƒ¼ãƒˆé–‹å§‹`);
            
            switch(currentSortAlgorithm) {
                case 'bubble':
                    await bubbleSortAnimation();
                    break;
                case 'selection':
                    await selectionSortAnimation();
                    break;
                case 'insertion':
                    await insertionSortAnimation();
                    break;
                case 'merge':
                    await mergeSortAnimation();
                    break;
                case 'quick':
                    await quickSortAnimation();
                    break;
                case 'heap':
                    await heapSortAnimation();
                    break;
            }
            
            const endTime = Date.now();
            document.getElementById('timeElapsed').textContent = `${endTime - startTime}ms`;
            
            // å…¨ã¦ã®è¦ç´ ã‚’ã‚½ãƒ¼ãƒˆæ¸ˆã¿ã«
            sortingArray.forEach((_, index) => {
                const element = document.getElementById(`sort-element-${index}`);
                element.classList.add('sorted');
            });
            
            isAnimating = false;
            logMessage(`${currentSortAlgorithm}ã‚½ãƒ¼ãƒˆå®Œäº†`);
        }

        // ãƒãƒ–ãƒ«ã‚½ãƒ¼ãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        async function bubbleSortAnimation() {
            const arr = [...sortingArray];
            const n = arr.length;
            
            for (let i = 0; i < n - 1; i++) {
                for (let j = 0; j < n - i - 1; j++) {
                    // æ¯”è¼ƒä¸­ã®è¦ç´ ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
                    highlightElements([j, j + 1], 'comparing');
                    stats.comparisons++;
                    stats.arrayAccesses += 2;
                    updateSortStats();
                    
                    await sleep(animationSpeed);
                    
                    if (arr[j] > arr[j + 1]) {
                        // äº¤æ›
                        [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
                        await swapElements(j, j + 1);
                        stats.swaps++;
                        updateSortStats();
                    }
                    
                    // ãƒã‚¤ãƒ©ã‚¤ãƒˆè§£é™¤
                    clearHighlights();
                }
                
                // ã‚½ãƒ¼ãƒˆå®Œäº†ã—ãŸè¦ç´ ã‚’ãƒãƒ¼ã‚¯
                const element = document.getElementById(`sort-element-${n - i - 1}`);
                element.classList.add('sorted');
                
                // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹æ›´æ–°
                const progress = ((i + 1) / (n - 1)) * 100;
                document.getElementById('sortProgress').style.width = `${progress}%`;
            }
            
            sortingArray = arr;
        }

        // é¸æŠã‚½ãƒ¼ãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        async function selectionSortAnimation() {
            const arr = [...sortingArray];
            const n = arr.length;
            
            for (let i = 0; i < n - 1; i++) {
                let minIdx = i;
                highlightElements([i], 'active');
                
                for (let j = i + 1; j < n; j++) {
                    highlightElements([j], 'comparing');
                    stats.comparisons++;
                    stats.arrayAccesses += 2;
                    updateSortStats();
                    
                    await sleep(animationSpeed / 2);
                    
                    if (arr[j] < arr[minIdx]) {
                        clearHighlights();
                        minIdx = j;
                        highlightElements([minIdx], 'active');
                    } else {
                        clearHighlights();
                        highlightElements([i, minIdx], 'active');
                    }
                }
                
                if (minIdx !== i) {
                    [arr[i], arr[minIdx]] = [arr[minIdx], arr[i]];
                    await swapElements(i, minIdx);
                    stats.swaps++;
                    updateSortStats();
                }
                
                const element = document.getElementById(`sort-element-${i}`);
                element.classList.add('sorted');
                clearHighlights();
                
                const progress = ((i + 1) / (n - 1)) * 100;
                document.getElementById('sortProgress').style.width = `${progress}%`;
            }
            
            sortingArray = arr;
        }

        // æŒ¿å…¥ã‚½ãƒ¼ãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        async function insertionSortAnimation() {
            const arr = [...sortingArray];
            const n = arr.length;
            
            for (let i = 1; i < n; i++) {
                let key = arr[i];
                let j = i - 1;
                
                highlightElements([i], 'active');
                await sleep(animationSpeed);
                
                while (j >= 0 && arr[j] > key) {
                    highlightElements([j, j + 1], 'comparing');
                    stats.comparisons++;
                    stats.arrayAccesses += 2;
                    updateSortStats();
                    
                    arr[j + 1] = arr[j];
                    await updateElementValue(j + 1, arr[j + 1]);
                    j--;
                    
                    await sleep(animationSpeed);
                }
                
                arr[j + 1] = key;
                await updateElementValue(j + 1, key);
                stats.arrayAccesses++;
                updateSortStats();
                
                clearHighlights();
                
                const progress = (i / (n - 1)) * 100;
                document.getElementById('sortProgress').style.width = `${progress}%`;
            }
            
            sortingArray = arr;
        }

        // ãƒãƒ¼ã‚¸ã‚½ãƒ¼ãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç°¡ç•¥ç‰ˆï¼‰
        async function mergeSortAnimation() {
            logMessage('ãƒãƒ¼ã‚¸ã‚½ãƒ¼ãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç°¡ç•¥ç‰ˆï¼‰ã‚’å®Ÿè¡Œä¸­...');
            await bubbleSortAnimation(); // ç°¡ç•¥ç‰ˆã¨ã—ã¦ä»–ã®ã‚½ãƒ¼ãƒˆã‚’ä½¿ç”¨
        }

        // ã‚¯ã‚¤ãƒƒã‚¯ã‚½ãƒ¼ãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç°¡ç•¥ç‰ˆï¼‰
        async function quickSortAnimation() {
            logMessage('ã‚¯ã‚¤ãƒƒã‚¯ã‚½ãƒ¼ãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç°¡ç•¥ç‰ˆï¼‰ã‚’å®Ÿè¡Œä¸­...');
            await bubbleSortAnimation(); // ç°¡ç•¥ç‰ˆã¨ã—ã¦ä»–ã®ã‚½ãƒ¼ãƒˆã‚’ä½¿ç”¨
        }

        // ãƒ’ãƒ¼ãƒ—ã‚½ãƒ¼ãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç°¡ç•¥ç‰ˆï¼‰
        async function heapSortAnimation() {
            logMessage('ãƒ’ãƒ¼ãƒ—ã‚½ãƒ¼ãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç°¡ç•¥ç‰ˆï¼‰ã‚’å®Ÿè¡Œä¸­...');
            await bubbleSortAnimation(); // ç°¡ç•¥ç‰ˆã¨ã—ã¦ä»–ã®ã‚½ãƒ¼ãƒˆã‚’ä½¿ç”¨
        }

        // è¦ç´ ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ
        function highlightElements(indices, className) {
            clearHighlights();
            indices.forEach(index => {
                const element = document.getElementById(`sort-element-${index}`);
                if (element) {
                    element.classList.add(className);
                }
            });
        }

        // ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚¯ãƒªã‚¢
        function clearHighlights() {
            document.querySelectorAll('.array-element').forEach(element => {
                element.classList.remove('active', 'comparing');
            });
        }

        // è¦ç´ ã®äº¤æ›ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        async function swapElements(i, j) {
            const element1 = document.getElementById(`sort-element-${i}`);
            const element2 = document.getElementById(`sort-element-${j}`);
            
            // å€¤ã‚’äº¤æ›
            const temp = element1.textContent;
            element1.textContent = element2.textContent;
            element2.textContent = temp;
            
            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœ
            element1.style.transform = 'scale(1.1)';
            element2.style.transform = 'scale(1.1)';
            
            await sleep(animationSpeed / 2);
            
            element1.style.transform = 'scale(1)';
            element2.style.transform = 'scale(1)';
        }

        // è¦ç´ ã®å€¤æ›´æ–°
        async function updateElementValue(index, value) {
            const element = document.getElementById(`sort-element-${index}`);
            if (element) {
                element.textContent = value;
                element.style.transform = 'scale(1.1)';
                await sleep(animationSpeed / 4);
                element.style.transform = 'scale(1)';
            }
        }

        // ã‚½ãƒ¼ãƒˆä¸€æ™‚åœæ­¢
        function pauseSorting() {
            isAnimating = false;
            logMessage('ã‚½ãƒ¼ãƒˆã‚’ä¸€æ™‚åœæ­¢');
        }

        // ã‚½ãƒ¼ãƒˆã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œ
        function stepSort() {
            // å®Ÿè£…ãŒè¤‡é›‘ãªãŸã‚ã€é€šå¸¸ã®ã‚½ãƒ¼ãƒˆã‚’ä½é€Ÿã§å®Ÿè¡Œ
            document.getElementById('speedSlider').value = 1;
            startSorting();
        }

        // æ¢ç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ é¸æŠ
        function selectSearchAlgorithm(algorithm) {
            document.querySelectorAll('#searching .algorithm-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.algorithm-card').classList.add('selected');
            
            currentSearchAlgorithm = algorithm;
            updateSearchExplanation(algorithm);
            logMessage(`æ¢ç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ : ${algorithm}ã‚’é¸æŠ`);
        }

        // æ¢ç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®èª¬æ˜æ›´æ–°
        function updateSearchExplanation(algorithm) {
            const explanations = {
                linear: {
                    title: 'ç·šå½¢æ¢ç´¢',
                    text: 'é…åˆ—ã®æœ€åˆã‹ã‚‰é †ç•ªã«è¦ç´ ã‚’ç¢ºèªã—ã¦ã„ãæœ€ã‚‚åŸºæœ¬çš„ãªæ¢ç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚',
                    code: `function linearSearch(arr, target) {
    for (let i = 0; i < arr.length; i++) {
        if (arr[i] === target) {
            return i;
        }
    }
    return -1;
}`
                },
                binary: {
                    title: 'äºŒåˆ†æ¢ç´¢',
                    text: 'ã‚½ãƒ¼ãƒˆæ¸ˆã¿é…åˆ—ã«å¯¾ã—ã¦ã€ä¸­å¤®ã®è¦ç´ ã¨æ¯”è¼ƒã—ãªãŒã‚‰æ¢ç´¢ç¯„å›²ã‚’åŠåˆ†ãšã¤ç‹­ã‚ã¦ã„ãåŠ¹ç‡çš„ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚',
                    code: `function binarySearch(arr, target) {
    let left = 0;
    let right = arr.length - 1;
    
    while (left <= right) {
        let mid = Math.floor((left + right) / 2);
        
        if (arr[mid] === target) {
            return mid;
        } else if (arr[mid] < target) {
            left = mid + 1;
        } else {
            right = mid - 1;
        }
    }
    return -1;
}`
                },
                jump: {
                    title: 'ã‚¸ãƒ£ãƒ³ãƒ—æ¢ç´¢',
                    text: 'ãƒ–ãƒ­ãƒƒã‚¯å˜ä½ã§è¦ç´ ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ãªãŒã‚‰æ¢ç´¢ã—ã€è¦‹ã¤ã‘ãŸãƒ–ãƒ­ãƒƒã‚¯å†…ã§ç·šå½¢æ¢ç´¢ã‚’è¡Œã†ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚',
                    code: `function jumpSearch(arr, target) {
    let n = arr.length;
    let step = Math.floor(Math.sqrt(n));
    let prev = 0;
    
    while (arr[Math.min(step, n) - 1] < target) {
        prev = step;
        step += Math.floor(Math.sqrt(n));
        if (prev >= n) return -1;
    }
    
    while (arr[prev] < target) {
        prev++;
        if (prev === Math.min(step, n)) return -1;
    }
    
    if (arr[prev] === target) return prev;
    return -1;
}`
                },
                interpolation: {
                    title: 'è£œé–“æ¢ç´¢',
                    text: 'ä¸€æ§˜åˆ†å¸ƒã—ãŸã‚½ãƒ¼ãƒˆæ¸ˆã¿é…åˆ—ã§ã€å€¤ã®å¤§å°é–¢ä¿‚ã‹ã‚‰æ¢ç´¢ä½ç½®ã‚’æ¨å®šã™ã‚‹é«˜é€Ÿãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚',
                    code: `function interpolationSearch(arr, target) {
    let low = 0;
    let high = arr.length - 1;
    
    while (low <= high && target >= arr[low] && target <= arr[high]) {
        if (low === high) {
            if (arr[low] === target) return low;
            return -1;
        }
        
        let pos = low + Math.floor(((target - arr[low]) / (arr[high] - arr[low])) * (high - low));
        
        if (arr[pos] === target) return pos;
        if (arr[pos] < target) low = pos + 1;
        else high = pos - 1;
    }
    return -1;
}`
                }
            };

            const explanation = explanations[algorithm];
            document.getElementById('searchExplanationTitle').textContent = explanation.title;
            document.getElementById('searchExplanationText').textContent = explanation.text;
            document.getElementById('searchCodeBlock').innerHTML = `<pre>${explanation.code}</pre>`;
        }

        // ã‚½ãƒ¼ãƒˆæ¸ˆã¿é…åˆ—ç”Ÿæˆ
        function generateSortedArray() {
            const size = 15;
            searchArray = Array.from({length: size}, (_, i) => (i + 1) * 2 - 1);
            document.getElementById('searchArrayInput').value = searchArray.join(',');
            displaySearchArray();
            logMessage('ã‚½ãƒ¼ãƒˆæ¸ˆã¿é…åˆ—ã‚’ç”Ÿæˆ');
        }

        // æ¢ç´¢é…åˆ—ã®è¡¨ç¤º
        function displaySearchArray() {
            const input = document.getElementById('searchArrayInput').value;
            searchArray = input.split(',').map(x => parseInt(x.trim())).filter(x => !isNaN(x));
            
            const visualization = document.getElementById('searchVisualization');
            visualization.innerHTML = '';
            
            searchArray.forEach((value, index) => {
                const element = document.createElement('div');
                element.className = 'array-element';
                element.textContent = value;
                element.id = `search-element-${index}`;
                
                const indexLabel = document.createElement('div');
                indexLabel.className = 'array-index';
                indexLabel.textContent = index;
                element.appendChild(indexLabel);
                
                visualization.appendChild(element);
            });
        }

        // æ¢ç´¢é–‹å§‹
        async function startSearch() {
            if (isAnimating) return;
            
            displaySearchArray();
            const target = parseInt(document.getElementById('searchValue').value);
            
            if (isNaN(target)) {
                logMessage('æœ‰åŠ¹ãªæ¤œç´¢å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            isAnimating = true;
            const startTime = Date.now();
            
            // çµ±è¨ˆãƒªã‚»ãƒƒãƒˆ
            stats.comparisons = 0;
            let steps = 0;
            document.getElementById('searchComparisons').textContent = '0';
            document.getElementById('searchSteps').textContent = '0';
            document.getElementById('searchResult').textContent = 'æ¤œç´¢ä¸­...';
            
            logMessage(`${currentSearchAlgorithm}æ¢ç´¢é–‹å§‹: å€¤ ${target} ã‚’æ¤œç´¢`);
            
            let result = -1;
            
            switch(currentSearchAlgorithm) {
                case 'linear':
                    result = await linearSearchAnimation(target);
                    break;
                case 'binary':
                    result = await binarySearchAnimation(target);
                    break;
                case 'jump':
                    result = await jumpSearchAnimation(target);
                    break;
                case 'interpolation':
                    result = await interpolationSearchAnimation(target);
                    break;
            }
            
            const endTime = Date.now();
            document.getElementById('searchTime').textContent = `${endTime - startTime}ms`;
            
            if (result !== -1) {
                document.getElementById('searchResult').textContent = `ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ ${result}`;
                const element = document.getElementById(`search-element-${result}`);
                element.classList.add('sorted');
                logMessage(`å€¤ ${target} ãŒã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ ${result} ã§è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ`);
            } else {
                document.getElementById('searchResult').textContent = 'è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“';
                logMessage(`å€¤ ${target} ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ`);
            }
            
            isAnimating = false;
        }

        // ç·šå½¢æ¢ç´¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        async function linearSearchAnimation(target) {
            for (let i = 0; i < searchArray.length; i++) {
                const element = document.getElementById(`search-element-${i}`);
                element.classList.add('comparing');
                
                stats.comparisons++;
                document.getElementById('searchComparisons').textContent = stats.comparisons;
                document.getElementById('searchSteps').textContent = i + 1;
                
                await sleep(500);
                
                if (searchArray[i] === target) {
                    element.classList.remove('comparing');
                    return i;
                }
                
                element.classList.remove('comparing');
                element.classList.add('visited');
            }
            
            return -1;
        }

        // äºŒåˆ†æ¢ç´¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        async function binarySearchAnimation(target) {
            let left = 0;
            let right = searchArray.length - 1;
            let steps = 0;
            
            while (left <= right) {
                const mid = Math.floor((left + right) / 2);
                steps++;
                
                // ç¾åœ¨ã®æ¢ç´¢ç¯„å›²ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
                for (let i = left; i <= right; i++) {
                    const element = document.getElementById(`search-element-${i}`);
                    element.classList.add('active');
                }
                
                // ä¸­å¤®è¦ç´ ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
                const midElement = document.getElementById(`search-element-${mid}`);
                midElement.classList.add('comparing');
                
                stats.comparisons++;
                document.getElementById('searchComparisons').textContent = stats.comparisons;
                document.getElementById('searchSteps').textContent = steps;
                
                await sleep(800);
                
                if (searchArray[mid] === target) {
                    // è¦‹ã¤ã‹ã£ãŸ
                    clearSearchHighlights();
                    return mid;
                } else if (searchArray[mid] < target) {
                    // å³åŠåˆ†ã‚’æ¢ç´¢
                    for (let i = left; i <= mid; i++) {
                        const element = document.getElementById(`search-element-${i}`);
                        element.classList.add('visited');
                    }
                    left = mid + 1;
                } else {
                    // å·¦åŠåˆ†ã‚’æ¢ç´¢
                    for (let i = mid; i <= right; i++) {
                        const element = document.getElementById(`search-element-${i}`);
                        element.classList.add('visited');
                    }
                    right = mid - 1;
                }
                
                clearSearchHighlights();
            }
            
            return -1;
        }

        // ã‚¸ãƒ£ãƒ³ãƒ—æ¢ç´¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç°¡ç•¥ç‰ˆï¼‰
        async function jumpSearchAnimation(target) {
            logMessage('ã‚¸ãƒ£ãƒ³ãƒ—æ¢ç´¢ï¼ˆç·šå½¢æ¢ç´¢ã§ä»£ç”¨ï¼‰');
            return await linearSearchAnimation(target);
        }

        // è£œé–“æ¢ç´¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç°¡ç•¥ç‰ˆï¼‰
        async function interpolationSearchAnimation(target) {
            logMessage('è£œé–“æ¢ç´¢ï¼ˆäºŒåˆ†æ¢ç´¢ã§ä»£ç”¨ï¼‰');
            return await binarySearchAnimation(target);
        }

        // æ¢ç´¢ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚¯ãƒªã‚¢
        function clearSearchHighlights() {
            document.querySelectorAll('#searchVisualization .array-element').forEach(element => {
                element.classList.remove('active', 'comparing');
            });
        }

        // æ¢ç´¢ãƒªã‚»ãƒƒãƒˆ
        function resetSearch() {
            clearSearchHighlights();
            document.querySelectorAll('#searchVisualization .array-element').forEach(element => {
                element.classList.remove('visited', 'sorted');
            });
            
            document.getElementById('searchComparisons').textContent = '0';
            document.getElementById('searchSteps').textContent = '0';
            document.getElementById('searchResult').textContent = 'æœªå®Ÿè¡Œ';
            document.getElementById('searchTime').textContent = '0ms';
            
            logMessage('æ¢ç´¢ã‚’ãƒªã‚»ãƒƒãƒˆ');
        }

        // ã‚°ãƒ©ãƒ•ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ é¸æŠ
        function selectGraphAlgorithm(algorithm) {
            document.querySelectorAll('#graphs .algorithm-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.algorithm-card').classList.add('selected');
            
            currentGraphAlgorithm = algorithm;
            updateGraphExplanation(algorithm);
            logMessage(`ã‚°ãƒ©ãƒ•ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ : ${algorithm}ã‚’é¸æŠ`);
        }

        // ã‚°ãƒ©ãƒ•ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®èª¬æ˜æ›´æ–°
        function updateGraphExplanation(algorithm) {
            const explanations = {
                dfs: {
                    title: 'æ·±ã•å„ªå…ˆæ¢ç´¢ (DFS)',
                    text: 'å¯èƒ½ãªé™ã‚Šæ·±ãæ¢ç´¢ã—ã¦ã‹ã‚‰ã€æ¬¡ã®åˆ†å²ã‚’æ¢ç´¢ã™ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚ã‚¹ã‚¿ãƒƒã‚¯ã¾ãŸã¯å†å¸°ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚',
                    code: `function dfs(graph, start, visited = new Set()) {
    visited.add(start);
    console.log(start);
    
    for (let neighbor of graph[start]) {
        if (!visited.has(neighbor)) {
            dfs(graph, neighbor, visited);
        }
    }
}`
                },
                bfs: {
                    title: 'å¹…å„ªå…ˆæ¢ç´¢ (BFS)',
                    text: 'ç¾åœ¨ã®æ·±åº¦ã®å…¨ã¦ã®ãƒãƒ¼ãƒ‰ã‚’æ¢ç´¢ã—ã¦ã‹ã‚‰ã€æ¬¡ã®æ·±åº¦ã«é€²ã‚€ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚ã‚­ãƒ¥ãƒ¼ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚',
                    code: `function bfs(graph, start) {
    let visited = new Set();
    let queue = [start];
    
    while (queue.length > 0) {
        let node = queue.shift();
        if (!visited.has(node)) {
            visited.add(node);
            console.log(node);
            
            for (let neighbor of graph[node]) {
                if (!visited.has(neighbor)) {
                    queue.push(neighbor);
                }
            }
        }
    }
}`
                },
                dijkstra: {
                    title: 'ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•',
                    text: 'é‡ã¿ä»˜ãã‚°ãƒ©ãƒ•ã§å˜ä¸€å§‹ç‚¹ã‹ã‚‰å…¨ã¦ã®é ‚ç‚¹ã¸ã®æœ€çŸ­è·é›¢ã‚’æ±‚ã‚ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚',
                    code: `function dijkstra(graph, start) {
    let distances = {};
    let visited = new Set();
    let pq = new PriorityQueue();
    
    distances[start] = 0;
    pq.enqueue(start, 0);
    
    while (!pq.isEmpty()) {
        let current = pq.dequeue();
        
        if (visited.has(current)) continue;
        visited.add(current);
        
        for (let neighbor of graph[current]) {
            let distance = distances[current] + neighbor.weight;
            if (distance < (distances[neighbor.node] || Infinity)) {
                distances[neighbor.node] = distance;
                pq.enqueue(neighbor.node, distance);
            }
        }
    }
    
    return distances;
}`
                },
                astar: {
                    title: 'A*ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ',
                    text: 'ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦åŠ¹ç‡çš„ã«æœ€çŸ­çµŒè·¯ã‚’è¦‹ã¤ã‘ã‚‹æ¢ç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚',
                    code: `function aStar(graph, start, goal, heuristic) {
    let openSet = new PriorityQueue();
    let gScore = new Map();
    let fScore = new Map();
    
    gScore.set(start, 0);
    fScore.set(start, heuristic(start, goal));
    openSet.enqueue(start, fScore.get(start));
    
    while (!openSet.isEmpty()) {
        let current = openSet.dequeue();
        
        if (current === goal) {
            return reconstructPath(cameFrom, current);
        }
        
        for (let neighbor of graph[current]) {
            let tentativeGScore = gScore.get(current) + distance(current, neighbor);
            
            if (tentativeGScore < (gScore.get(neighbor) || Infinity)) {
                gScore.set(neighbor, tentativeGScore);
                fScore.set(neighbor, gScore.get(neighbor) + heuristic(neighbor, goal));
                openSet.enqueue(neighbor, fScore.get(neighbor));
            }
        }
    }
    
    return null;
}`
                }
            };

            const explanation = explanations[algorithm];
            document.getElementById('graphExplanationTitle').textContent = explanation.title;
            document.getElementById('graphExplanationText').textContent = explanation.text;
            document.getElementById('graphCodeBlock').innerHTML = `<pre>${explanation.code}</pre>`;
        }

        // ã‚°ãƒ©ãƒ•ç”Ÿæˆ
        function generateGraph() {
            const graphType = document.getElementById('graphType').value;
            
            // 5x5ã‚°ãƒªãƒƒãƒ‰ã‚°ãƒ©ãƒ•ã‚’ç”Ÿæˆ
            graphNodes = [];
            graph = [];
            
            for (let i = 0; i < 25; i++) {
                graph[i] = [];
                graphNodes[i] = {
                    id: i,
                    x: 100 + (i % 5) * 80,
                    y: 80 + Math.floor(i / 5) * 80,
                    visited: false,
                    current: false
                };
            }
            
            // ã‚°ãƒªãƒƒãƒ‰æ¥ç¶šã‚’ä½œæˆ
            for (let i = 0; i < 25; i++) {
                const row = Math.floor(i / 5);
                const col = i % 5;
                
                // å³ã®éš£æ¥ãƒãƒ¼ãƒ‰
                if (col < 4) {
                    graph[i].push(i + 1);
                }
                // å·¦ã®éš£æ¥ãƒãƒ¼ãƒ‰
                if (col > 0) {
                    graph[i].push(i - 1);
                }
                // ä¸‹ã®éš£æ¥ãƒãƒ¼ãƒ‰
                if (row < 4) {
                    graph[i].push(i + 5);
                }
                // ä¸Šã®éš£æ¥ãƒãƒ¼ãƒ‰
                if (row > 0) {
                    graph[i].push(i - 5);
                }
            }
            
            drawGraph();
            logMessage(`${graphType}ã‚°ãƒ©ãƒ•ã‚’ç”Ÿæˆ`);
        }

        // ã‚°ãƒ©ãƒ•æç”»
        function drawGraph() {
            const canvas = document.getElementById('graphCanvas');
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ã‚¨ãƒƒã‚¸ã‚’æç”»
            for (let i = 0; i < graph.length; i++) {
                const node = graphNodes[i];
                for (let neighbor of graph[i]) {
                    if (neighbor > i) { // é‡è¤‡æç”»ã‚’é¿ã‘ã‚‹
                        const neighborNode = graphNodes[neighbor];
                        
                        ctx.strokeStyle = '#cbd5e1';
                        ctx.lineWidth = 2;
                        ctx.beginPath();
                        ctx.moveTo(node.x, node.y);
                        ctx.lineTo(neighborNode.x, neighborNode.y);
                        ctx.stroke();
                    }
                }
            }
            
            // ãƒãƒ¼ãƒ‰ã‚’æç”»
            graphNodes.forEach(node => {
                ctx.fillStyle = node.visited ? '#10b981' : (node.current ? '#f59e0b' : '#3b82f6');
                ctx.beginPath();
                ctx.arc(node.x, node.y, 15, 0, 2 * Math.PI);
                ctx.fill();
                
                ctx.strokeStyle = '#1e293b';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // ãƒãƒ¼ãƒ‰ç•ªå·
                ctx.fillStyle = 'white';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(node.id, node.x, node.y + 4);
            });
        }

        // ã‚°ãƒ©ãƒ•æ¢ç´¢é–‹å§‹
        async function startGraphTraversal() {
            if (isAnimating) return;
            
            const startNode = parseInt(document.getElementById('startNode').value);
            const endNode = parseInt(document.getElementById('endNode').value);
            
            if (startNode < 0 || startNode >= 25 || endNode < 0 || endNode >= 25) {
                logMessage('æœ‰åŠ¹ãªãƒãƒ¼ãƒ‰ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ (0-24)');
                return;
            }
            
            isAnimating = true;
            resetGraphStats();
            
            // å…¨ãƒãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ
            graphNodes.forEach(node => {
                node.visited = false;
                node.current = false;
            });
            
            const startTime = Date.now();
            logMessage(`${currentGraphAlgorithm}æ¢ç´¢é–‹å§‹: ${startNode} â†’ ${endNode}`);
            
            let result = [];
            
            switch(currentGraphAlgorithm) {
                case 'dfs':
                    result = await dfsAnimation(startNode, endNode);
                    break;
                case 'bfs':
                    result = await bfsAnimation(startNode, endNode);
                    break;
                case 'dijkstra':
                    result = await dijkstraAnimation(startNode, endNode);
                    break;
                case 'astar':
                    result = await astarAnimation(startNode, endNode);
                    break;
            }
            
            const endTime = Date.now();
            document.getElementById('graphTime').textContent = `${endTime - startTime}ms`;
            document.getElementById('pathLength').textContent = result.length;
            
            const efficiency = result.length > 0 ? Math.round((result.length / stats.visitedNodes) * 100) : 0;
            document.getElementById('efficiency').textContent = `${efficiency}%`;
            
            isAnimating = false;
            logMessage(`ã‚°ãƒ©ãƒ•æ¢ç´¢å®Œäº†: ãƒ‘ã‚¹é•· ${result.length}`);
        }

        // DFSã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        async function dfsAnimation(start, target) {
            const visited = new Set();
            const path = [];
            
            async function dfsRecursive(node) {
                if (visited.has(node)) return false;
                
                visited.add(node);
                path.push(node);
                stats.visitedNodes++;
                document.getElementById('visitedNodes').textContent = stats.visitedNodes;
                
                graphNodes[node].current = true;
                drawGraph();
                await sleep(600);
                
                if (node === target) {
                    return true;
                }
                
                graphNodes[node].visited = true;
                graphNodes[node].current = false;
                
                for (let neighbor of graph[node]) {
                    if (await dfsRecursive(neighbor)) {
                        return true;
                    }
                }
                
                path.pop();
                return false;
            }
            
            await dfsRecursive(start);
            return path;
        }

        // BFSã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        async function bfsAnimation(start, target) {
            const visited = new Set();
            const queue = [start];
            const parent = new Map();
            
            visited.add(start);
            
            while (queue.length > 0) {
                const node = queue.shift();
                stats.visitedNodes++;
                document.getElementById('visitedNodes').textContent = stats.visitedNodes;
                
                graphNodes[node].current = true;
                drawGraph();
                await sleep(600);
                
                if (node === target) {
                    // ãƒ‘ã‚¹ã‚’å†æ§‹ç¯‰
                    const path = [];
                    let current = target;
                    while (current !== undefined) {
                        path.unshift(current);
                        current = parent.get(current);
                    }
                    return path;
                }
                
                graphNodes[node].visited = true;
                graphNodes[node].current = false;
                
                for (let neighbor of graph[node]) {
                    if (!visited.has(neighbor)) {
                        visited.add(neighbor);
                        parent.set(neighbor, node);
                        queue.push(neighbor);
                    }
                }
                
                drawGraph();
            }
            
            return [];
        }

        // ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç°¡ç•¥ç‰ˆï¼‰
        async function dijkstraAnimation(start, target) {
            logMessage('ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•ï¼ˆBFSã§ä»£ç”¨ï¼‰');
            return await bfsAnimation(start, target);
        }

        // A*ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç°¡ç•¥ç‰ˆï¼‰
        async function astarAnimation(start, target) {
            logMessage('A*ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆBFSã§ä»£ç”¨ï¼‰');
            return await bfsAnimation(start, target);
        }

        // ã‚°ãƒ©ãƒ•çµ±è¨ˆãƒªã‚»ãƒƒãƒˆ
        function resetGraphStats() {
            stats.visitedNodes = 0;
            document.getElementById('visitedNodes').textContent = '0';
            document.getElementById('pathLength').textContent = '0';
            document.getElementById('graphTime').textContent = '0ms';
            document.getElementById('efficiency').textContent = '0%';
        }

        // ã‚°ãƒ©ãƒ•ãƒªã‚»ãƒƒãƒˆ
        function resetGraph() {
            graphNodes.forEach(node => {
                node.visited = false;
                node.current = false;
            });
            drawGraph();
            resetGraphStats();
            logMessage('ã‚°ãƒ©ãƒ•ã‚’ãƒªã‚»ãƒƒãƒˆ');
        }

        // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // åˆæœŸåŒ–æ™‚ã®è¨­å®š
        window.addEventListener('resize', () => {
            drawDataStructure();
            drawGraph();
        });

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†æ™‚ã®å‡¦ç†
        window.addEventListener('load', () => {
            logMessage('ãƒ‡ãƒ¼ã‚¿æ§‹é€ ãƒ»ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å¯è¦–åŒ–ãƒ„ãƒ¼ãƒ«æº–å‚™å®Œäº†');
            updateDataStructureExplanation('array');
            updateSortExplanation('bubble');
            updateSearchExplanation('linear');
            updateGraphExplanation('dfs');
        });
    </script>
</body>
</html>